!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.cellsNative=t():e.cellsNative=t()}(window,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var i in e)t.d(r,i,function(t){return e[t]}.bind(null,i));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=8)}([,function(e,t,n){"use strict";function r(e){for(var t=e.split("."),n=[],r=0;r<t.length;r++){for(var i=t[r];"\\"===i[i.length-1]&&void 0!==t[r+1];)i=i.slice(0,-1)+".",i+=t[++r];n.push(i)}return n}var i=n(7);e.exports={get:function(e,t,n){if(!i(e)||"string"!=typeof t)return void 0===n?e:n;for(var o=r(t),a=0;a<o.length;a++){if(!Object.prototype.propertyIsEnumerable.call(e,o[a]))return n;if(e=e[o[a]],void 0===e||null===e){if(a!==o.length-1)return n;break}}return e},set:function(e,t,n){if(i(e)&&"string"==typeof t)for(var o=r(t),a=0;a<o.length;a++){var s=o[a];i(e[s])||(e[s]={}),a===o.length-1&&(e[s]=n),e=e[s]}},delete:function(e,t){if(i(e)&&"string"==typeof t)for(var n=r(t),o=0;o<n.length;o++){var a=n[o];if(o===n.length-1)return void delete e[a];if(e=e[a],!i(e))return}},has:function(e,t){if(!i(e)||"string"!=typeof t)return!1;for(var n=r(t),o=0;o<n.length;o++){if(!i(e))return!1;if(!(n[o]in e))return!1;e=e[n[o]]}return!0}}},,function(e,t,n){"use strict";function r(e){console&&console.warn&&console.warn(e)}function i(){i.init.call(this)}function o(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function a(e){return void 0===e._maxListeners?i.defaultMaxListeners:e._maxListeners}function s(e,t,n,i){var s,u,c;if(o(n),u=e._events,void 0===u?(u=e._events=Object.create(null),e._eventsCount=0):(void 0!==u.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),u=e._events),c=u[t]),void 0===c)c=u[t]=n,++e._eventsCount;else if("function"==typeof c?c=u[t]=i?[n,c]:[c,n]:i?c.unshift(n):c.push(n),s=a(e),s>0&&c.length>s&&!c.warned){c.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+c.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=c.length,r(l)}return e}function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function c(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=u.bind(r);return i.listener=n,r.wrapFn=i,i}function l(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?v(i):f(i,i.length)}function h(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function f(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function p(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function v(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}var d,g="object"==typeof Reflect?Reflect:null,y=g&&"function"==typeof g.apply?g.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};d=g&&"function"==typeof g.ownKeys?g.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var m=Number.isNaN||function(e){return e!==e};e.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var b=10;Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return b},set:function(e){if("number"!=typeof e||e<0||m(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");b=e}}),i.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||m(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},i.prototype.getMaxListeners=function(){return a(this)},i.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var s=i[e];if(void 0===s)return!1;if("function"==typeof s)y(s,this,t);else for(var u=s.length,c=f(s,u),n=0;n<u;++n)y(c[n],this,t);return!0},i.prototype.addListener=function(e,t){return s(this,e,t,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(e,t){return s(this,e,t,!0)},i.prototype.once=function(e,t){return o(t),this.on(e,c(this,e,t)),this},i.prototype.prependOnceListener=function(e,t){return o(t),this.prependListener(e,c(this,e,t)),this},i.prototype.removeListener=function(e,t){var n,r,i,a,s;if(o(t),r=this._events,void 0===r)return this;if(n=r[e],void 0===n)return this;if(n===t||n.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,a=n.length-1;a>=0;a--)if(n[a]===t||n[a].listener===t){s=n[a].listener,i=a;break}if(i<0)return this;0===i?n.shift():p(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,s||t)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(e){var t,n,r;if(n=this._events,void 0===n)return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)i=o[r],"removeListener"!==i&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],"function"==typeof t)this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},i.prototype.listeners=function(e){return l(this,e,!0)},i.prototype.rawListeners=function(e){return l(this,e,!1)},i.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):h.call(e,t)},i.prototype.listenerCount=h,i.prototype.eventNames=function(){return this._eventsCount>0?d(this._events):[]}},function(e,t,n){(function(e){!function(t,n){e.exports=n()}(this,function(){"use strict";function t(e){var t=this;return function(){var n=a(regeneratorRuntime.mark(function n(r){var i,o,a,s,u,c;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=r.url,o=r.body,a=r.headers,s={method:e,body:JSON.stringify(o),headers:{"content-type":"application/json"}},a&&Object.keys(a).forEach(function(e){var t=a[e];s.headers[e]=t}),t.next=5,fetch(i,s);case 5:if(u=t.sent,u.ok){t.next=8;break}return t.abrupt("return",null);case 8:return c={},t.prev=9,t.next=12,u.json();case 12:c=t.sent,t.next=17;break;case 15:t.prev=15,t.t0=t.catch(9);case 17:return t.abrupt("return",c);case 18:case"end":return t.stop()}},n,t,[[9,15]])}));return function(e){return n.apply(this,arguments)}}()}function n(e){return function(t,n,i){return{configurable:!0,enumerable:i.enumerable,get:function(){return Object.defineProperty(this,n,{configurable:!0,enumerable:i.enumerable,value:r(i.value,e)}),this[n]}}}}function r(e){function t(){for(var i=this,o=arguments.length,a=Array(o),s=0;s<o;s++)a[s]=arguments[s];t.clear(),r=setTimeout(function(){r=null,e.apply(i,a)},n)}var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:V,r=void 0;return t.clear=function(){r&&(clearTimeout(r),r=null)},t}function i(e,t,n,r,i){var o={};return Object.keys(r).forEach(function(e){o[e]=r[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(i,o){try{var a=t[i](o),s=a.value}catch(e){return void n(e)}return a.done?void e(s):Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)})}return r("next")})}},s=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},h=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)};!function(t){function n(e,t,n,r){var o=t&&t.prototype instanceof i?t:i,a=Object.create(o.prototype),s=new v(r||[]);return a._invoke=l(e,n,s),a}function r(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}function i(){}function a(){}function s(){}function u(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function c(e){function t(n,i,a,s){var u=r(e[n],e,i);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"===("undefined"==typeof l?"undefined":o(l))&&b.call(l,"__await")?Promise.resolve(l.__await).then(function(e){t("next",e,a,s)},function(e){t("throw",e,a,s)}):Promise.resolve(l).then(function(e){c.value=e,a(c)},s)}s(u.arg)}function n(e,n){function r(){return new Promise(function(r,i){t(e,n,r,i)})}return i=i?i.then(r,r):r()}var i;this._invoke=n}function l(e,t,n){var i=S;return function(o,a){if(i===O)throw new Error("Generator is already running");if(i===N){if("throw"===o)throw a;return g()}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=h(s,n);if(u){if(u===R)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===S)throw i=N,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=O;var c=r(e,t,n);if("normal"===c.type){if(i=n.done?N:P,c.arg===R)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(i=N,n.method="throw",n.arg=c.arg)}}}function h(e,t){var n=e.iterator[t.method];if(n===y){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=y,h(e,t),"throw"===t.method))return R;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return R}var i=r(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,R;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=y),t.delegate=null,R):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,R)}function f(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function p(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function v(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(f,this),this.reset(!0)}function d(e){if(e){var t=e[E];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(b.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=y,t.done=!0,t};return r.next=r}}return{next:g}}function g(){return{value:y,done:!0}}var y,m=Object.prototype,b=m.hasOwnProperty,_="function"==typeof Symbol?Symbol:{},E=_.iterator||"@@iterator",k=_.asyncIterator||"@@asyncIterator",w=_.toStringTag||"@@toStringTag",C="object"===o(e),T=t.regeneratorRuntime;if(T)return void(C&&(e.exports=T));T=t.regeneratorRuntime=C?e.exports:{},T.wrap=n;var S="suspendedStart",P="suspendedYield",O="executing",N="completed",R={},A={};A[E]=function(){return this};var I=Object.getPrototypeOf,x=I&&I(I(d([])));x&&x!==m&&b.call(x,E)&&(A=x);var L=s.prototype=i.prototype=Object.create(A);a.prototype=L.constructor=s,s.constructor=a,s[w]=a.displayName="GeneratorFunction",T.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===a||"GeneratorFunction"===(t.displayName||t.name))},T.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,w in e||(e[w]="GeneratorFunction")),e.prototype=Object.create(L),e},T.awrap=function(e){return{__await:e}},u(c.prototype),c.prototype[k]=function(){return this},T.AsyncIterator=c,T.async=function(e,t,r,i){var o=new c(n(e,t,r,i));return T.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},u(L),L[w]="Generator",L[E]=function(){return this},L.toString=function(){return"[object Generator]"},T.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},T.values=d,v.prototype={constructor:v,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=y,this.done=!1,this.delegate=null,this.method="next",this.arg=y,this.tryEntries.forEach(p),!e)for(var t in this)"t"===t.charAt(0)&&b.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=y)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){function t(t,r){return o.type="throw",o.arg=e,n.next=t,r&&(n.method="next",n.arg=y),!!r}if(this.done)throw e;for(var n=this,r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],o=i.completion;if("root"===i.tryLoc)return t("end");if(i.tryLoc<=this.prev){var a=b.call(i,"catchLoc"),s=b.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return t(i.catchLoc,!0);if(this.prev<i.finallyLoc)return t(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return t(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return t(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&b.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,R):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),R},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),p(n),R}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;p(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:d(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=y),R}}}(function(){return this}()||Function("return this")());var f,p,v=["consumerId","policy","mrId","nameSpace","region","dnsTld","tsec2JWTEndpoint"],d={DEFAULT_ADAPTER_IDENTIFIER:"application",DEFAULT_ADAPTER_VERSION:"v1",REQUIRED_FIELDS:v,ALLOWED_FIELDS:[].concat(v,["identifier","version"])},g=function(e){return function(t,n,r){return"https://"+e+"."+[t,n].filter(Boolean).join(".")+"/"+r}},y={HOST:g("rho"),ALLOWED_FIELDS:["mrId","spanId","startDate","finishDate","name","parentSpan","traceId","properties","duration","recordDate"],REQUIRED_FIELDS:[]},m={HOST:g("omega"),DEFAULT_LOG_LEVEL:"DEBUG",ALLOWED_FIELDS:["mrId","spanId","traceId","creationDate","level","message","properties"],MAXIMUM_BULK_SIZE:1e3,REQUIRED_FIELDS:[]},b={SEMAAS:d,RHO:y,OMEGA:m},_=function(e){var t="_",n={},r=function e(r,i){Object.keys(r).forEach(function(a){var s=r[a],u=i?i+t+a:a;s&&"object"===("undefined"==typeof s?"undefined":o(s))?e(s,u):n[u]=s})};return r(e),n},E=function(e,t){var n=l({},e);return Object.keys(n).forEach(function(e){t.includes(e)||delete n[e]}),n.properties&&(n.properties=_(n.properties)),n},k=function(e){return function(t){return Object.prototype.hasOwnProperty.call(e,t)&&!!e[t]}},w=function(e,t){return t.every(k(e))},C=function(e,t){return e.reduce(function(e,n){var r=t instanceof Function?t(n):n[t],i=e.find(function(e){return e&&e.key===r});return i?i.values.push(n):e.push({key:r,values:[n]}),e},[])},T=function(){for(var e=[],t="0123456789abcdef",n=0;n<36;n++)e[n]=t.substr(Math.floor(16*Math.random()),1);e[14]="4",e[19]=t.substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-";var r=e.join("");return r},S={dotify:_,sanitizeObj:E,hasProperty:k,hasProperties:w,groupBy:C,createUUID:T},P=b.OMEGA,O=P.DEFAULT_LOG_LEVEL,N=P.ALLOWED_FIELDS,R=S.sanitizeObj,A=function(){function e(t){s(this,e),this.mrId=null,this.mrId=t}return u(e,[{key:"createLog",value:function(e){var t=this.mrId,n=R(e,N),r={mrId:t,creationDate:1e6*Date.now(),level:O};return l({},r,n)}}]),e}(),I=b.RHO,x=I.ALLOWED_FIELDS,L=S.sanitizeObj,M=S.createUUID,j=function(){function e(t){s(this,e),this.spanId=null,this.initialize(t)}return u(e,[{key:"initialize",value:function(e){var t=this;x.forEach(function(n){e[n]&&(t[n]=e[n])}),this.spanId=M(),this.start()}},{key:"start",value:function(){this.startDate=1e6*Date.now()}},{key:"finish",value:function(){this.finishDate=1e6*Date.now()}}]),e}(),D=function(){function e(t){s(this,e),this.mrId=null,this.mrId=t}return u(e,[{key:"createUUID",value:function(){return M()}},{key:"createSpan",value:function(e,t){var n=this.mrId,r=e.mrId,i=void 0===r?n:r,o=e.parentSpan,a=this.getParentSpan(o,i,t),s=l({},e,{mrId:i,parentSpan:a}),u=new j(s);return u}},{key:"buildSpans",value:function(e){var t=Array.isArray(e)?[].concat(h(e)):[e];return t.map(function(e){return L(e,x)})}},{key:"getParentSpan",value:function(e,t,n){return e?[n,t,"spans",e].join("/"):null}}]),e}(),B={Omega:A,Rho:D},U={GET:t("get"),POST:t("post")},F=function(){function e(){s(this,e)}return u(e,null,[{key:"get",value:function(){function e(e,n){return t.apply(this,arguments)}var t=a(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",U.GET({url:t,headers:n}));case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"post",value:function(){function e(e,n,r){return t.apply(this,arguments)}var t=a(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",U.POST({url:t,body:n,headers:r}));case 1:case"end":return e.stop()}},e,this)}));return e}()}]),e}(),V=500,H=function(e){return function(t,n,r){var i=r.value;return e.slice().reverse().forEach(function(e){return i=e(i)}),l({},r,{value:i})}},G={outerDecorator:n,decorate:H},q=S.groupBy,z=1e3,W=function(){function e(t){s(this,e),this.items=[],this.identifier=null,this.identifier=t}return u(e,[{key:"add",value:function(e,t){var n=this,r=Array.isArray(t)?[].concat(h(t)):[t];r.forEach(function(t){var r={data:t,endpoint:e};n.items.push(r)})}},{key:"dump",value:function(){if(!this.any())return null;var e=q(this.items,"endpoint"),t=e[0].values,n=t.slice(0,z),r=this.items.filter(function(e){return!n.includes(e)});return console.log("Dumping "+n.length+" items from "+this.identifier+" queue ("+this.items.length+")..."),this.items=r,n}},{key:"any",value:function(){return null!==this.items&&this.items.length>0}}]),e}(),K=B.Omega,Y=B.Rho,Q=b.SEMAAS,J=Q.REQUIRED_FIELDS,$=Q.ALLOWED_FIELDS,X=Q.DEFAULT_ADAPTER_IDENTIFIER,Z=Q.DEFAULT_ADAPTER_VERSION,ee=b.OMEGA.HOST,te=b.RHO.HOST,ne=S.hasProperties,re=G.outerDecorator,ie=(f=re(5e3),p=function(){function e(t){s(this,e),this.nameSpace=null,this.identifier=X,this.mrId=null,this.consumerId=null,this.policy=null,this.region=null,this.dnsTld=null,this.version=Z,this.tsec2JWTEndpoint=null,this.apiKey=null,this.omega=null,this.rho=null,this.queue=null,this.setup(t)}return u(e,[{key:"setup",value:function(e){if(!e||!this.validateConfig(e,J))throw new Error("Invalid setup for SEMaaS adapter ("+this.identifier+"). Required fields: "+J.join(", ")+".");this.initialize(e)}},{key:"validateConfig",value:function(e,t){return ne(e,t)}},{key:"initialize",value:function(e){var t=this;$.forEach(function(n){e[n]&&(t[n]=e[n])});var n=this.nameSpace,r=this.identifier,i=this.mrId,o=this.tsec2JWTEndpoint,a=this.region,s=this.dnsTld,u=this.version;this.omega=new K(i),this.rho=new Y(i),this.queue=new W(r),console.info("SEMaaS adapter for "+a+" (TSEC: "+o+") ["+s+" - "+u+"] ("+r+" - ns: "+n+", mrId: "+i+") successfully initialized.")}},{key:"log",value:function(e){var t=this.omega.createLog(e);this.enqueue(this.omegaEndpoint,t)}},{key:"ingest",value:function(e){var t=this.rho.buildSpans(e);this.enqueue(this.rhoEndpoint,t)}},{key:"createSpan",value:function(e){var t=this.rho.createSpan(e,this.prefixForChildSpan);return t}},{key:"createUUID",value:function(){var e=this.rho.createUUID();return e}},{key:"send",value:function(){function e(e,n,r){return t.apply(this,arguments)}var t=a(regeneratorRuntime.mark(function e(t,n,r){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=void 0,e.prev=1,e.next=4,F.post(t,n,r);case 4:i=e.sent,e.next=9;break;case 7:e.prev=7,e.t0=e.catch(1);case 9:return i||(console.log("There was a problem while sending data to SEMaaS - operation will be queued."),this.enqueue(t,n)),e.abrupt("return",i);case 11:case"end":return e.stop()}},e,this,[[1,7]])}));return e}()},{key:"enqueue",value:function(e,t){this.queue.add(e,t),this.flush()}},{key:"flush",value:function(){function e(){return t.apply(this,arguments)}var t=a(regeneratorRuntime.mark(function e(){var t,n,r,i,o,a,s=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ensureValidApiKey();case 2:if(t=e.sent){e.next=6;break}return console.log("No valid API Key for SEMaaS adapter ("+this.identifier+") - aborting operation"),e.abrupt("return");case 6:if(n=this.queue.dump()){e.next=10;break}return console.log("Empty queue for SEMaaS adapter ("+this.identifier+")"),e.abrupt("return");case 10:r=n[0].endpoint,i=this.apiKey,console.log("Sending queued batch "+r+" - "+i),o=n.map(function(e){return e.data}),a=this.buildApiHeaders(),this.send(r,o,a).then(function(){return s.queue.any()&&s.flush()});case 16:case"end":return e.stop()}},e,this)}));return e}()},{key:"ensureValidApiKey",value:function(){function e(){return t.apply(this,arguments)}var t=a(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.hasApiKey){e.next=5;break}return console.log("ApiKey OK -> next()"),e.abrupt("return",!0);case 5:if(!this.hasCredentials){e.next=8;break}return console.log("ApiKey KO, Credentials OK -> getApiKey()"),e.abrupt("return",this.getApiKey());case 8:return console.log("No ApiKey && No Credentials -> KO"),e.abrupt("return",!1);case 10:case"end":return e.stop()}},e,this)}));return e}()},{key:"buildApiHeaders",value:function(){var e=void 0,t=void 0;switch(this.version.toLowerCase()){case"v1":e="Authorization",t="Bearer "+this.apiKey;break;default:e="Api-Key",t="jwt "+this.apiKey}return c({},e,t)}},{key:"getApiKey",value:function(){function e(){return t.apply(this,arguments)}var t=a(regeneratorRuntime.mark(function e(){var t,n,r,i,o,a,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.consumerId,n=this.policy,r=this.tsec2JWTEndpoint,i={"x-consumer-id":t,"x-tsec-token":window.sessionStorage.getItem("tsec"),"x-validation-policy":n},o=r,e.next=5,F.get(o,i);case 5:if(a=e.sent){e.next=8;break}return e.abrupt("return",null);case 8:return s=a.accessToken,this.apiKey=s,e.abrupt("return",s);case 11:case"end":return e.stop()}},e,this)}));return e}()},{key:"getEndpoint",value:function(e){var t=this.region,n=this.dnsTld,r=this.version;return e(t,n,r)}},{key:"hasApiKey",get:function(){return!!this.apiKey}},{key:"hasCredentials",get:function(){return!!this.consumerId&&!!this.policy&&!!this.tsec}},{key:"initialized",get:function(){return!!this.omega&&!!this.rho}},{key:"omegaEndpoint",get:function(){var e=this.nameSpace,t=this.getEndpoint(ee);return t+"/ns/"+e+"/logs"}},{key:"rhoEndpoint",get:function(){var e=this.nameSpace,t=this.getEndpoint(te);return t+"/ns/"+e+"/spans"}},{key:"prefixForChildSpan",get:function(){return"ns/"+this.nameSpace+"/mrs"}},{key:"tsec",get:function(){return window.sessionStorage.getItem("tsec")}}]),e}(),i(p.prototype,"flush",[f],Object.getOwnPropertyDescriptor(p.prototype,"flush"),p.prototype),p);return ie})}).call(this,n(6)(e))},function(e,t){Object.values||(Object.values=function(e){return Object.keys(e).map(function(t){return e[t]})}),Object.entries||(Object.entries=function(e){for(var t=Object.keys(e),n=t.length,r=new Array(n);n--;)r[n]=[t[n],e[t[n]]];return r}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var n=this.toString();("number"!=typeof t||!isFinite(t)||Math.floor(t)!==t||t>n.length)&&(t=n.length),t-=e.length;var r=n.indexOf(e,t);return r!==-1&&r===t})},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){"use strict";e.exports=function(e){var t=typeof e;return null!==e&&("object"===t||"function"===t)}},function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(){return f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f.apply(this,arguments)}function p(e){"@babel/helpers - typeof";return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),e}function y(){return y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},y.apply(this,arguments)}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _(e,t,n){return t&&b(e.prototype,t),n&&b(e,n),e}function E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function w(e,t,n){return t&&k(e.prototype,t),n&&k(e,n),e}function C(){return C=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},C.apply(this,arguments)}function T(e){return O(e)||P(e)||S()}function S(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function P(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function O(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function N(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function A(e,t,n){return t&&R(e.prototype,t),n&&R(e,n),e}function I(){return I=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},I.apply(this,arguments)}function x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function L(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function M(e,t,n){return t&&L(e.prototype,t),n&&L(e,n),e}function j(e,t){function n(){this.constructor=e}io(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function D(e){return"function"==typeof e}function B(e){setTimeout(function(){throw e},0)}function U(e){return null!==e&&"object"==typeof e}function F(e){return e.reduce(function(e,t){return e.concat(t instanceof lo?t.errors:t)},[])}function V(e){for(;e;){var t=e,n=t.closed,r=t.destination,i=t.isStopped;if(n||i)return!1;e=r&&r instanceof po?r:null}return!0}function H(e,t,n){if(e){if(e instanceof po)return e;if(e[fo])return e[fo]();
}return e||t||n?new po(e,t,n):new po(so)}function G(){}function q(e){return e?1===e.length?e[0]:function(t){return e.reduce(function(e,t){return t(e)},t)}:G}function z(e){if(e||(e=ao.Promise||Promise),!e)throw new Error("no Promise impl found");return e}function W(e,t){return function(n){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new mo(e,t))}}function K(e,t,n,r){return D(n)&&(r=n,n=void 0),r?K(e,t,n).pipe(W(function(e){return uo(e)?r.apply(void 0,e):r(e)})):new yo(function(r){function i(e){arguments.length>1?r.next(Array.prototype.slice.call(arguments)):r.next(e)}Y(e,t,i,r,n)})}function Y(e,t,n,r,i){var o;if($(e)){var a=e;e.addEventListener(t,n,i),o=function(){return a.removeEventListener(t,n,i)}}else if(J(e)){var s=e;e.on(t,n),o=function(){return s.off(t,n)}}else if(Q(e)){var u=e;e.addListener(t,n),o=function(){return u.removeListener(t,n)}}else{if(!e||!e.length)throw new TypeError("Invalid event target");for(var c=0,l=e.length;c<l;c++)Y(e[c],t,n,r,i)}r.add(o)}function Q(e){return e&&"function"==typeof e.addListener&&"function"==typeof e.removeListener}function J(e){return e&&"function"==typeof e.on&&"function"==typeof e.off}function $(e){return e&&"function"==typeof e.addEventListener&&"function"==typeof e.removeEventListener}function X(e,t){return function(n){return n.lift(new _o(e,t))}}function Z(e){return e?ee(e):Mo}function ee(e){return new yo(function(t){return e.schedule(function(){return t.complete()})})}function te(e){return e&&"function"==typeof e.schedule}function ne(e,t){return new yo(function(n){var r=new ho,i=0;return r.add(t.schedule(function(){return i===e.length?void n.complete():(n.next(e[i++]),void(n.closed||r.add(this.schedule())))})),r})}function re(e,t){return t?ne(e,t):new yo(jo(e))}function ie(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[e.length-1];return te(n)?(e.pop(),ne(e,n)):re(e)}function oe(e,t){return new yo(t?function(n){return t.schedule(ae,0,{error:e,subscriber:n})}:function(t){return t.error(e)})}function ae(e){var t=e.error,n=e.subscriber;n.error(t)}function se(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ue(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ce(e,t,n){return t&&ue(e.prototype,t),n&&ue(e,n),e}function le(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function he(e,t){return ve(e)||pe(e,t)||fe()}function fe(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function pe(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}function ve(e){if(Array.isArray(e))return e}function de(){return de=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},de.apply(this,arguments)}function ge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ye(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function me(e,t,n){return t&&ye(e.prototype,t),n&&ye(e,n),e}function be(){return be=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},be.apply(this,arguments)}function _e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ee(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ke(e,t,n){return t&&Ee(e.prototype,t),n&&Ee(e,n),e}function we(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Te(e,t,n){return t&&Ce(e.prototype,t),n&&Ce(e,n),e}function Se(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}function Pe(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}function Oe(e,t,n,r,i){if(void 0===i&&(i=new ra(e,n,r)),!i.closed)return t instanceof yo?t.subscribe(i):ca(t)(i)}function Ne(e,t){return new yo(function(n){var r=new ho;return r.add(t.schedule(function(){var i=e[go]();r.add(i.subscribe({next:function(e){r.add(t.schedule(function(){return n.next(e)}))},error:function(e){r.add(t.schedule(function(){return n.error(e)}))},complete:function(){r.add(t.schedule(function(){return n.complete()}))}}))})),r})}function Re(e,t){return new yo(function(n){var r=new ho;return r.add(t.schedule(function(){return e.then(function(e){r.add(t.schedule(function(){n.next(e),r.add(t.schedule(function(){return n.complete()}))}))},function(e){r.add(t.schedule(function(){return n.error(e)}))})})),r})}function Ae(e,t){if(!e)throw new Error("Iterable cannot be null");return new yo(function(n){var r,i=new ho;return i.add(function(){r&&"function"==typeof r.return&&r.return()}),i.add(t.schedule(function(){r=e[oa](),i.add(t.schedule(function(){if(!n.closed){var e,t;try{var i=r.next();e=i.value,t=i.done}catch(e){return void n.error(e)}t?n.complete():(n.next(e),this.schedule())}}))})),i})}function Ie(e){return e&&"function"==typeof e[go]}function xe(e){return e&&"function"==typeof e[oa]}function Le(e,t){if(null!=e){if(Ie(e))return Ne(e,t);if(Pe(e))return Re(e,t);if(ua(e))return ne(e,t);if(xe(e)||"string"==typeof e)return Ae(e,t)}throw new TypeError((null!==e&&typeof e||e)+" is not observable")}function Me(e,t){return t?Le(e,t):e instanceof yo?e:new yo(ca(e))}function je(e,t,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),"function"==typeof t?function(r){return r.pipe(je(function(n,r){return Me(e(n,r)).pipe(W(function(e,i){return t(n,e,r,i)}))},n))}:("number"==typeof t&&(n=t),function(t){return t.lift(new ha(e,n))})}function De(e){return e}function Be(e){return void 0===e&&(e=Number.POSITIVE_INFINITY),je(De,e)}function Ue(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Number.POSITIVE_INFINITY,r=null,i=e[e.length-1];return te(i)?(r=e.pop(),e.length>1&&"number"==typeof e[e.length-1]&&(n=e.pop())):"number"==typeof i&&(n=e.pop()),null===r&&1===e.length&&e[0]instanceof yo?e[0]:Be(n)(re(e,r))}function Fe(){return Be(1)}function Ve(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Fe()(ie.apply(void 0,e))}function He(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[e.length-1];return te(n)?(e.pop(),function(t){return Ve(e,t,n)}):function(t){return Ve(e,t)}}function Ge(e,t){return function(n){return n.lift(new pa(e,t))}}function qe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ze(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function We(e,t,n){return t&&ze(e.prototype,t),n&&ze(e,n),e}function Ke(e,t){return Je(e)||Qe(e,t)||Ye()}function Ye(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function Qe(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}function Je(e){if(Array.isArray(e))return e}function $e(e){"@babel/helpers - typeof";return($e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ze(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function et(e,t,n){return t&&Ze(e.prototype,t),n&&Ze(e,n),e}function tt(e,t){return!t||"object"!==$e(t)&&"function"!=typeof t?nt(e):t}function nt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rt(e,t,n){return(rt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=it(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function it(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ot(e),null!==e););return e}function ot(e){return(ot=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function at(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&st(e,t)}function st(e,t){return(st=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ut(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ct(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function lt(e,t,n){return t&&ct(e.prototype,t),n&&ct(e,n),e}function ht(e){"@babel/helpers - typeof";return(ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vt(e,t,n){return t&&pt(e.prototype,t),n&&pt(e,n),e}function dt(e,t){return!t||"object"!==ht(t)&&"function"!=typeof t?gt(e):t}function gt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yt(e){return(yt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mt(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bt(e,t)}function bt(e,t){return(bt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _t(e){"@babel/helpers - typeof";return(_t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Et(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wt(e,t,n){return t&&kt(e.prototype,t),n&&kt(e,n),e}function Ct(e,t){return!t||"object"!==_t(t)&&"function"!=typeof t?Tt(e):t}function Tt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function St(e){return(St=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Pt(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ot(e,t)}function Ot(e,t){return(Ot=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Nt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function At(e,t,n){return t&&Rt(e.prototype,t),n&&Rt(e,n),e}function It(e){return function(t){return 0===e?Z():t.lift(new Ba(e))}}function xt(e){return void 0===e&&(e=null),function(t){return t.lift(new Fa(e))}}function Lt(e){return void 0===e&&(e=Mt),function(t){return t.lift(new Ha(e))}}function Mt(){return new Ma}function jt(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?X(function(t,n){return e(t,n,r)}):De,It(1),n?xt(t):Lt(function(){return new Ma}))}}function Dt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ut(e,t,n){return t&&Bt(e.prototype,t),n&&Bt(e,n),e}function Ft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ht(e,t,n){return t&&Vt(e.prototype,t),n&&Vt(e,n),e}function Gt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zt(e,t,n){return t&&qt(e.prototype,t),n&&qt(e,n),e}function Wt(){return Wt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Wt.apply(this,arguments)}function Kt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Yt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qt(e,t,n){return t&&Yt(e.prototype,t),n&&Yt(e,n),e}function Jt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $t(){return $t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},$t.apply(this,arguments)}function Xt(e){"function"==typeof e&&(Rs=e)}function Zt(e,t){var n=en(),r=e.spec,i=e.node[Wo]||Rs;return Object.defineProperty(e.node,Wo,{value:function(){return nn(e,t,i)}}),r.connections&&r.connections.in?$t(r.connections.in,n.in):r.connections?$t(r.connections,n):r.connections=n,Ko.set(e.node,e.node[Wo]()),e}function en(){return{in:Jt({},zo,{bind:Wo})}}function tn(e,t){return t.node.style.visibility=e?"initial":"hidden",!!e}function nn(e,t,n){var r=t.featureFlagCollection,i=t.ComponentConnector,o=r.value(e.spec.featureFlag),a=n.call(e.node,o,e)!==!1,s=e.spec.connections;if(a)i._updateInConnections(e.node,s.in);else if(i.subscriptors.has(e.node)){var u=Object.keys(s.in).filter(function(e){return e!==zo});i.unsubscribe(u,e.node)}return Ko.set(e.node,a),a}function rn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function on(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function an(e,t,n){return t&&on(e.prototype,t),n&&on(e,n),e}function sn(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function un(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){function o(e){sn(s,r,i,o,a,"next",e)}function a(e){sn(s,r,i,o,a,"throw",e)}var s=e.apply(t,n);o(void 0)})}}function cn(){return cn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},cn.apply(this,arguments)}function ln(e){"@babel/helpers - typeof";return(ln="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pn(e,t,n){return t&&fn(e.prototype,t),n&&fn(e,n),e}function vn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gn(e,t,n){return t&&dn(e.prototype,t),n&&dn(e,n),e}function yn(e,t){return!t||"object"!==Cn(t)&&"function"!=typeof t?mn(e):t}function mn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bn(e,t,n){return(bn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=_n(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function _n(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=En(e),null!==e););return e}function En(e){return(En=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function kn(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wn(e,t)}function wn(e,t){return(wn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Cn(e){"@babel/helpers - typeof";return(Cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tn(e){var t=e.tagName.indexOf("-")>-1,n=e.__isPolymerInstance__===!0,r=void 0!==Polymer.Element&&e instanceof Polymer.Element||void 0!==Polymer.ElementMixin&&e instanceof Polymer.ElementMixin||void 0!==Polymer.LegacyElementMixin&&e instanceof Polymer.LegacyElementMixin||void 0!==e.is&&void 0!==e.ready&&void 0!==e.notifyPath,i=e.updateComplete instanceof Promise&&"function"==typeof e.render;return t&&!n&&!r&&!i}function Sn(e){"@babel/helpers - typeof";return(Sn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function On(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Nn(e,t,n){return t&&On(e.prototype,t),n&&On(e,n),e}function Rn(e,t){return!t||"object"!==Sn(t)&&"function"!=typeof t?An(e):t}function An(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function In(e){return(In=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xn(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ln(e,t)}function Ln(e,t){return(Ln=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Mn(e){"@babel/helpers - typeof";return(Mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Dn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Bn(e,t,n){return t&&Dn(e.prototype,t),n&&Dn(e,n),e}function Un(e,t){return!t||"object"!==Mn(t)&&"function"!=typeof t?Fn(e):t}function Fn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vn(e){return(Vn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Hn(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gn(e,t)}function Gn(e,t){return(Gn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qn(e){"@babel/helpers - typeof";return(qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Wn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Kn(e,t,n){return t&&Wn(e.prototype,t),n&&Wn(e,n),e}function Yn(e,t){return!t||"object"!==qn(t)&&"function"!=typeof t?Qn(e):t}function Qn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jn(e){return(Jn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xn(e,t)}function Xn(e,t){return(Xn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Zn(e){"@babel/helpers - typeof";return(Zn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function er(){return er=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},er.apply(this,arguments)}function tr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rr(e,t,n){return t&&nr(e.prototype,t),n&&nr(e,n),e}function ir(e,t){return!t||"object"!==Zn(t)&&"function"!=typeof t?or(e):t}function or(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ar(e,t,n){return(ar="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=sr(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function sr(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ur(e),null!==e););return e}function ur(e){return(ur=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function cr(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lr(e,t)}function lr(e,t){return(lr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function hr(e){"@babel/helpers - typeof";return(hr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vr(e,t,n){return t&&pr(e.prototype,t),n&&pr(e,n),e}function dr(e,t){return!t||"object"!==hr(t)&&"function"!=typeof t?gr(e):t}function gr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yr(e){return(yr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mr(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&br(e,t)}function br(e,t){return(br=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Er(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kr(e,t,n){return t&&Er(e.prototype,t),n&&Er(e,n),e}function wr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Cr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Tr(e,t,n){return t&&Cr(e.prototype,t),n&&Cr(e,n),e}function Sr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Or(e,t,n){return t&&Pr(e.prototype,t),n&&Pr(e,n),e}function Nr(e){"@babel/helpers - typeof";return(Nr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rr(){return Rr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Rr.apply(this,arguments)}function Ar(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ir(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xr(e,t,n){return t&&Ir(e.prototype,t),n&&Ir(e,n),e}function Lr(e,t){return!t||"object"!==Nr(t)&&"function"!=typeof t?Mr(e):t}function Mr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jr(e,t,n){return(jr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=Dr(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function Dr(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Br(e),null!==e););return e}function Br(e){return(Br=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ur(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fr(e,t)}function Fr(e,t){return(Fr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Vr(e){"@babel/helpers - typeof";return(Vr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qr(e,t,n){return t&&Gr(e.prototype,t),n&&Gr(e,n),e}function zr(e,t){return!t||"object"!==Vr(t)&&"function"!=typeof t?Wr(e):t}function Wr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kr(e){return(Kr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Yr(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qr(e,t)}function Qr(e,t){return(Qr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Jr(e){"@babel/helpers - typeof";return(Jr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Zr(e,t,n){return t&&Xr(e.prototype,t),n&&Xr(e,n),e}function ei(e,t){return!t||"object"!==Jr(t)&&"function"!=typeof t?ti(e):t}function ti(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ni(e,t,n){return(ni="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=ri(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function ri(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ii(e),null!==e););return e}function ii(e){return(ii=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function oi(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ai(e,t)}function ai(e,t){return(ai=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function si(e){"@babel/helpers - typeof";return(si="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ui(){return ui=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ui.apply(this,arguments)}function ci(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function li(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function hi(e,t,n){return t&&li(e.prototype,t),n&&li(e,n),e}function fi(e,t){
return!t||"object"!==si(t)&&"function"!=typeof t?pi(e):t}function pi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vi(e,t,n){return(vi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=di(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function di(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=gi(e),null!==e););return e}function gi(e){return(gi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yi(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mi(e,t)}function mi(e,t){return(mi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.r(t);var bi=(n(5),n(3)),_i=n.n(bi),Ei=20,ki=function(e){function t(){return i(this,t),s(this,c(t).apply(this,arguments))}return l(t,e),a(t,[{key:"listenToOnce",value:function(e,t,n){var r=function(){n(),e.removeEventListener(t,r)}.bind(this);e.addEventListener(t,r)}}]),t}(_i.a),wi=new ki;wi.setMaxListeners(Ei);var Ci,Ti=wi,Si={ALWAYS:"always",DELAYED:"delayed",UI:"ui",CURRENTVIEW:"currentview"},Pi={DEFAULT:Si.ALWAYS,VALUES:Object.values(Si)},Oi={PAGE_READY:"page-ready",PARSE_ROUTE:"parse-route",AFTER_PUBLISH:"after-publish",NAV_REQUEST:"nav-request",BEFORE_SET_ATTR_TO_NODE:"before-set-attr-to-node",AFTER_SET_ATTR_TO_NODE:"after-set-attr-to-node",BEFORE_CREATE_NODE:"before-create-node",AFTER_CREATE_NODE:"after-create-node",BEFORE_IMPORT:"before-import",AFTER_IMPORT:"after-import",PAGE_REQUEST:"page-request",PAGE_RESPONSE:"page-response",DATA_LOAD:"data-load",TEMPLATE_TRANSITION_END:"template-transition-end",TRACK_EVENT:"track-event",TEMPLATE_REGISTERED:"template-registered",ROUTER_BACKSTEP:"router-backstep",LOG_EVENT:"log-event"},Ni=Object.values(Oi),Ri="./bower_components/",Ai="./composerMocks/",Ii="",xi="login",Li="core",Mi="ether.cells",ji={SEMAAS:{policy:"ei_bbva_es",mrId:Li,nameSpace:Mi,identifier:"bridge",consumerId:"core@ether.cells"}},Di="./pages/",Bi={NONE:"none",DEFER:"defer",PROGRESSIVE:"progressive",HERO:"hero"},Ui={DEFAULT:Bi.DEFER,VALUES:Object.values(Bi)},Fi={WORKING:"working",REQUESTED:"requested"},Vi={litElement:"litElement"},Hi={bindingCodes:Si,binding:Pi,componentsPath:Ri,composerEndpoint:Ai,deployEndpoint:Ii,externalEvents:Ni,externalEventsCodes:Oi,initialTemplate:xi,monitoring:ji,pagesPath:Di,prplCodes:Bi,prpl:Ui,preRenderState:Fi,renderEngines:Vi},Gi=Hi.externalEventsCodes,qi=function(){function e(){v(this,e)}return g(e,[{key:"createComponents",value:function(e){if(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e[r];t[n]=this.createElement(i.tagName),t[n].__zone=i.zone,n++}return t}}},{key:"setAttrs",value:function(e,t){var n=Gi.BEFORE_SET_ATTR_TO_NODE,r=Gi.AFTER_SET_ATTR_TO_NODE;t&&"object"===p(t)&&(Ti.emit(n,e.tagName),f(e,t),Ti.emit(r,e))}},{key:"createElement",value:function(e,t){var n=Gi.BEFORE_CREATE_NODE,r=Gi.AFTER_CREATE_NODE;Ti.emit(n,e);var i=document.createElement(e);return Ti.emit(r,i),t&&this.setAttrs(i,t),i}}]),e}(),zi=qi,Wi=function(){function e(){m(this,e),this.dictionary={}}return _(e,[{key:"getItem",value:function(e){return this.dictionary[e]||null}},{key:"setItem",value:function(e,t){this.dictionary[e]=t}}]),e}(),Ki=function(){function e(t){m(this,e),this.prefix="",this.persistent=!1,this.internalStorage=new Wi,y(this,t),this.persistent&&this.clear()}return _(e,[{key:"getItem",value:function(e){return JSON.parse(this.storage.getItem(this.prefix+e))}},{key:"setItem",value:function(e,t){this.storage.setItem(this.prefix+e,JSON.stringify(t,"",!0))}},{key:"clear",value:function(){var e=new RegExp("^("+this.prefix+")");for(var t in this.storage)this.storage.hasOwnProperty(t)&&e.test(t)&&this.storage.removeItem(t)}},{key:"storage",get:function(){var e;e=this.persistent?window.localStorage:window.sessionStorage;try{e.setItem("_$_",{})}catch(t){e=this.internalStorage}return e}}]),e}(),Yi=function(){function e(){E(this,e)}return w(e,[{key:"_get",value:function(e,t){return new Promise(function(n,r){var i=new XMLHttpRequest;if(!e||!e.url)return void r(new Error("URL not defined"));var o=(e.method||"").toUpperCase()||"GET";i.addEventListener("load",function(e){var i=e.target,o=i.status;o>=200&&o<300||0==o&&i.responseText.length>0?n("json"===t?JSON.parse(i.response):i.responseText):r(new Error(i.statusText))}),i.addEventListener("error",function(){r(new Error("Network Error"))}),i.open(o,e.url);var a=e.headers;for(var s in a)a.hasOwnProperty(s)&&i.setRequestHeader(s,a[s]);i.send(e.body)})}},{key:"getJSON",value:function(e){return this._get(e,"json")}},{key:"getHTML",value:function(e){return this._get(e,"html")}}]),e}(),Qi=function(e){return e.trim().replace(/[_\s]+/g,"-").replace(/([A-Z])/g,"-$1").replace(/-+/g,"-").toLowerCase()},Ji=function(e){return e.trim().replace(/(-|_|\s)+(.)?/g,function(e,t,n){return n?n.toUpperCase():""})},$i={dasherize:Qi,camelize:Ji},Xi=$i.dasherize,Zi=function(e){var t=e.familyPath,n=e.tag,r=e.tagName,i=n||r,o=t||i;return"".concat(o,"/").concat(i,".html")},eo=function(){function e(){N(this,e)}return A(e,[{key:"_buildConfig",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"UI",n=e.type,r=e.tag,i=e.tagName,o=e.zone,a=e.fixed,s=e.priority,u=e.properties,c=e.render,l=e.featureFlag,h=Zi(e),f=n?n.toUpperCase():t,p={type:f,tagName:r||i,zone:o,fixed:a,priority:s,properties:u,path:h,render:c,featureFlag:l};return this._parseConnections(p)}},{key:"parse",value:function(e){var t=[],n=/^\/(\b)/;t.push.apply(t,T(this._parseComponentsFromJson(e,"components","UI")));var r=e.template;r&&(r=this._buildConfig(r,"TEMPLATE"));var i={},o=e.pages;if(o)for(var a=0;a<Object.keys(o).length;a++){var s=Object.keys(o)[a];i[s]="/"+o[s].url.replace(n,"")}return{page:e.page,currentPage:e.currentPage||{},template:r,components:t,pages:i}}},{key:"_parseComponentsFromJson",value:function(e,t,n){var r=[],i=e[t];if(Array.isArray(i))for(var o=0;o<i.length;o++){var a=i[o];r.push(this._buildConfig(a,n))}return r}},{key:"_parseConnections",value:function(e){var t=this._normalizeComponentDefinition(e),n=t.properties.cellsConnections;if(!n||!Object.keys(n).length>0)return t;var r=C({},t);if(n.params){var i=this._parseConnectionsParams(n.params);n.in||(n.in={}),n.out||(n.out={}),C(n.in,i.in),C(n.out,i.out)}return r.connections=n,r}},{key:"_normalizeComponentDefinition",value:function(e){var t={cellsConnections:{in:{},out:{}}},n=C({},e);return n.properties=n.properties||t,n}},{key:"_parseConnectionsParams",value:function(e){var t={in:{},out:{}};for(var n in e)if(e.hasOwnProperty(n)){var r=e[n],i=Xi(n)+"-changed";t.in[r]=this._createConnection(n),t.out[r]=this._createConnection(i)}return t}},{key:"_createConnection",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return{bind:e,global:t}}},{key:"split",value:function(e){var t;if(e){t={CC:[],UI:[],DM:[]};for(var n=0;n<e.length;n++){var r=e[n];t[r.type].push(r)}}return t}}]),e}(),to=Hi.externalEventsCodes,no=function(){function e(t){x(this,e),this._initCellsPageManager(t)}return M(e,[{key:"_initCellsPageManager",value:function(e){var t=e.htmlPagesPath,n=void 0===t?"./pages/":t,r=e.htmlPages,i=e.templatesPath,o=e.composerEndpoint,a=e.remoteTemplates,s=e.appId,u=e.getPlatform,c=e.cache,l=e.storagePrefix,h=e.composerEngine,f=e.TemplateManager,p=new Ki({prefix:l,persistent:c}),v=new Yi,d=new eo;I(this,{storage:p,htmlPagesPath:n,htmlPages:r,templatesPath:i,composerEndpoint:o,remoteTemplates:a,appId:s,getPlatform:u,cache:c,connector:v,sanitizer:d,composerEngine:h,TemplateManager:f})}},{key:"_remoteTemplate",value:function(e){var t=this.composerEndpoint.replace(/{appId}/,this.appId);return this.getPlatform&&(t=t.replace(/{platform}/,this.getPlatform())),t=t.replace(/{page}/,e)}},{key:"_localTemplate",value:function(e){var t=this.templatesPath?this.templatesPath:this.composerEndpoint;return"".concat(t).concat(e,".json")}},{key:"_isLocalComposer",value:function(e){var t=!0,n=this.templatesPath&&this.templatesPath.length>0,r=this.remoteTemplates&&this.remoteTemplates.length>0,i=this.composerEndpoint&&!n&&!r;return t=i?0!==this.composerEndpoint.indexOf("http"):!this.composerEndpoint||!this.remoteTemplates||this.remoteTemplates.indexOf(e)<0}},{key:"_renderComposerEndpoint",value:function(e){return this._isLocalComposer(e)?this._localTemplate(e):this._remoteTemplate(e)}},{key:"generateRequestUrl",value:function(e){return this.htmlPages&&this.htmlPages.indexOf(e)>=0?this.htmlPagesPath+e+".html":this._renderComposerEndpoint(e)}},{key:"onPageDefinitionNotFound",value:function(e){}},{key:"clear",value:function(){this.storage.clear()}},{key:"get",value:function(e,t,n){var r,i=this.composerEngine&&!this._isLocalComposer(e);return i?(this.TemplateManager.removeTemplate(e),this._getFromComposerEngine(e,t)):(r=this.storage.getItem(e),this.cache&&r?Promise.resolve(r):this._getFromConnector(e,t,n))}},{key:"_getFromComposerEngine",value:function(e,t){var n=JSON.parse(this.composerEngine.getPage(e));return Promise.resolve(this._onResponse(e,t,n))}},{key:"_getFromConnector",value:function(e,t,n){var r=this,i=to.PAGE_REQUEST;return t=t||{},t.url=this.generateRequestUrl(e,t,n),Ti.emit(i,t),this.connector.getJSON(t).then(function(n){return r._onResponse(e,t,n)}).catch(function(t){return r._onResponseFail(e),console.error(t),t.message})}},{key:"getPage",value:function(e,t){var n=this,r=to.PAGE_REQUEST;return t=t||{},t.url=this.generateRequestUrl(e),Ti.emit(r,t),this.connector.getHTML(t).then(function(r){return n._onResponseHTML(e,t,r)}).catch(function(t){return n._onResponseFail(e),console.error(t),t.message})}},{key:"_onResponse",value:function(e,t,n){var r=to.PAGE_RESPONSE,i=to.DATA_LOAD;n.page=e,Ti.emit(r,n);var o=this.sanitizer.parse(n);return this.storage.setItem(e,o),Ti.emit(i,o),o}},{key:"_onResponseHTML",value:function(e,t,n){var r=to.PAGE_RESPONSE,i=to.DATA_LOAD,o={page:e,html:n};Ti.emit(r,o);var a={page:e,currentPage:{},template:{},components:[],pages:[],html:n};return this.storage.setItem(e,a),Ti.emit(i,a),a}},{key:"_onResponseFail",value:function(e){return this.onPageDefinitionNotFound&&this.onPageDefinitionNotFound(e),Promise.reject(new Error("Definition file for page '".concat(e,"' not found.")))}}]),e}(),ro=no,io=function(e,t){return(io=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},oo=!1,ao={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){if(e){var t=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+t.stack)}else oo&&console.log("RxJS: Back to a better error behavior. Thank you. <3");oo=e},get useDeprecatedSynchronousErrorHandling(){return oo}},so={closed:!0,next:function(e){},error:function(e){if(ao.useDeprecatedSynchronousErrorHandling)throw e;B(e)},complete:function(){}},uo=function(){return Array.isArray||function(e){return e&&"number"==typeof e.length}}(),co=function(){function e(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map(function(e,t){return t+1+") "+e.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),lo=co,ho=function(){function e(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._unsubscribe=e)}return e.prototype.unsubscribe=function(){var t;if(!this.closed){var n=this,r=n._parentOrParents,i=n._unsubscribe,o=n._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,r instanceof e)r.remove(this);else if(null!==r)for(var a=0;a<r.length;++a){var s=r[a];s.remove(this)}if(D(i))try{i.call(this)}catch(e){t=e instanceof lo?F(e.errors):[e]}if(uo(o))for(var a=-1,u=o.length;++a<u;){var c=o[a];if(U(c))try{c.unsubscribe()}catch(e){t=t||[],e instanceof lo?t=t.concat(F(e.errors)):t.push(e)}}if(t)throw new lo(t)}},e.prototype.add=function(t){var n=t;if(!t)return e.EMPTY;switch(typeof t){case"function":n=new e(t);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof e)){var r=n;n=new e,n._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var i=n._parentOrParents;if(null===i)n._parentOrParents=this;else if(i instanceof e){if(i===this)return n;n._parentOrParents=[i,this]}else{if(i.indexOf(this)!==-1)return n;i.push(this)}var o=this._subscriptions;return null===o?this._subscriptions=[n]:o.push(n),n},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var n=t.indexOf(e);n!==-1&&t.splice(n,1)}},e.EMPTY=function(e){return e.closed=!0,e}(new e),e}(),fo=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),po=function(e){function t(n,r,i){var o=e.call(this)||this;switch(o.syncErrorValue=null,o.syncErrorThrown=!1,o.syncErrorThrowable=!1,o.isStopped=!1,arguments.length){case 0:o.destination=so;break;case 1:if(!n){o.destination=so;break}if("object"==typeof n){n instanceof t?(o.syncErrorThrowable=n.syncErrorThrowable,o.destination=n,n.add(o)):(o.syncErrorThrowable=!0,o.destination=new vo(o,n));break}default:o.syncErrorThrowable=!0,o.destination=new vo(o,n,r,i)}return o}return j(t,e),t.prototype[fo]=function(){return this},t.create=function(e,n,r){var i=new t(e,n,r);return i.syncErrorThrowable=!1,i},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this},t}(ho),vo=function(e){function t(t,n,r,i){var o=e.call(this)||this;o._parentSubscriber=t;var a,s=o;return D(n)?a=n:n&&(a=n.next,r=n.error,i=n.complete,n!==so&&(s=Object.create(n),D(s.unsubscribe)&&o.add(s.unsubscribe.bind(s)),s.unsubscribe=o.unsubscribe.bind(o))),o._context=s,o._next=a,o._error=r,o._complete=i,o}return j(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;ao.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber,n=ao.useDeprecatedSynchronousErrorHandling;if(this._error)n&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)n?(t.syncErrorValue=e,t.syncErrorThrown=!0):B(e),this.unsubscribe();else{if(this.unsubscribe(),n)throw e;B(e)}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var n=function(){return e._complete.call(e._context)};ao.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){if(this.unsubscribe(),ao.useDeprecatedSynchronousErrorHandling)throw e;B(e)}},t.prototype.__tryOrSetError=function(e,t,n){if(!ao.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,n)}catch(t){return ao.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=t,e.syncErrorThrown=!0,!0):(B(t),!0)}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(po),go=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}(),yo=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r=this.operator,i=H(e,t,n);if(r?i.add(r.call(i,this.source)):i.add(this.source||ao.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),ao.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){ao.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),V(e)?e.error(t):console.warn(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=z(t))(function(t,r){var i;i=n.subscribe(function(t){try{e(t)}catch(e){r(e),i&&i.unsubscribe()}},r,t)})},e.prototype._subscribe=function(e){var t=this.source;return t&&t.subscribe(e)},e.prototype[go]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?this:q(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=z(e))(function(e,n){var r;t.subscribe(function(e){return r=e},function(e){return n(e)},function(){return e(r)})})},e.create=function(t){return new e(t)},e}(),mo=function(){function e(e,t){this.project=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new bo(e,this.project,this.thisArg))},e}(),bo=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.project=n,i.count=0,i.thisArg=r||i,i}return j(t,e),t.prototype._next=function(e){var t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(po),_o=(function(){return Object.prototype.toString}(),function(){function e(e,t){this.predicate=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new Eo(e,this.predicate,this.thisArg))},e}()),Eo=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.predicate=n,i.thisArg=r,i.count=0,i}return j(t,e),t.prototype._next=function(e){var t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}t&&this.destination.next(e)},t}(po),ko=function(){function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e}(),wo=ko,Co=function(e){function t(t,n){var r=e.call(this)||this;return r.subject=t,r.subscriber=n,r.closed=!1,r}return j(t,e),t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var n=t.indexOf(this.subscriber);n!==-1&&t.splice(n,1)}}},t}(ho),To=function(e){function t(t){var n=e.call(this,t)||this;return n.destination=t,n}return j(t,e),t}(po),So=function(e){function t(){var t=e.call(this)||this;return t.observers=[],t.closed=!1,t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return j(t,e),t.prototype[fo]=function(){return new To(this)},t.prototype.lift=function(e){var t=new Po(this,this);return t.operator=e,t},t.prototype.next=function(e){if(this.closed)throw new wo;if(!this.isStopped)for(var t=this.observers,n=t.length,r=t.slice(),i=0;i<n;i++)r[i].next(e)},t.prototype.error=function(e){if(this.closed)throw new wo;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,n=t.length,r=t.slice(),i=0;i<n;i++)r[i].error(e);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new wo;this.isStopped=!0;for(var e=this.observers,t=e.length,n=e.slice(),r=0;r<t;r++)n[r].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype._trySubscribe=function(t){if(this.closed)throw new wo;return e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){if(this.closed)throw new wo;return this.hasError?(e.error(this.thrownError),ho.EMPTY):this.isStopped?(e.complete(),ho.EMPTY):(this.observers.push(e),new Co(this,e))},t.prototype.asObservable=function(){var e=new yo;return e.source=this,e},t.create=function(e,t){return new Po(e,t)},t}(yo),Po=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return j(t,e),t.prototype.next=function(e){var t=this.destination;t&&t.next&&t.next(e)},t.prototype.error=function(e){var t=this.destination;t&&t.error&&this.destination.error(e)},t.prototype.complete=function(){var e=this.destination;e&&e.complete&&this.destination.complete()},t.prototype._subscribe=function(e){var t=this.source;return t?this.source.subscribe(e):ho.EMPTY},t}(So),Oo=function(e){function t(t,n){return e.call(this)||this}return j(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(ho),No=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r.pending=!1,r}return j(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){return void 0===n&&(n=0),null!==n&&this.delay===n&&this.pending===!1?t:void clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);return n?n:void(this.pending===!1&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null)))},t.prototype._execute=function(e,t){var n=!1,r=void 0;try{this.work(e)}catch(e){n=!0,r=!!e&&e||new Error(e)}if(n)return this.unsubscribe(),r},t.prototype._unsubscribe=function(){var e=this.id,t=this.scheduler,n=t.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,r!==-1&&n.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null},t}(Oo),Ro=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return j(t,e),t.prototype.schedule=function(t,n){return void 0===n&&(n=0),n>0?e.prototype.schedule.call(this,t,n):(this.delay=n,this.state=t,this.scheduler.flush(this),this)},t.prototype.execute=function(t,n){return n>0||this.closed?e.prototype.execute.call(this,t,n):this._execute(t,n)},t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0?e.prototype.requestAsyncId.call(this,t,n,r):t.flush(this)},t}(No),Ao=function(){function e(t,n){void 0===n&&(n=e.now),this.SchedulerAction=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.SchedulerAction(this,e).schedule(n,t)},e.now=function(){return Date.now()},e}(),Io=function(e){function t(n,r){void 0===r&&(r=Ao.now);var i=e.call(this,n,function(){return t.delegate&&t.delegate!==i?t.delegate.now():r()})||this;return i.actions=[],i.active=!1,i.scheduled=void 0,i}return j(t,e),t.prototype.schedule=function(n,r,i){return void 0===r&&(r=0),t.delegate&&t.delegate!==this?t.delegate.schedule(n,r,i):e.prototype.schedule.call(this,n,r,i)},t.prototype.flush=function(e){var t=this.actions;if(this.active)return void t.push(e);var n;this.active=!0;do if(n=e.execute(e.state,e.delay))break;while(e=t.shift());if(this.active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}},t}(Ao),xo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return j(t,e),t}(Io),Lo=new xo(Ro),Mo=new yo(function(e){return e.complete()}),jo=function(e){return function(t){for(var n=0,r=e.length;n<r&&!t.closed;n++)t.next(e[n]);t.complete()}};!function(e){e.NEXT="N",e.ERROR="E",e.COMPLETE="C"}(Ci||(Ci={}));var Do=function(){function e(e,t,n){this.kind=e,this.value=t,this.error=n,this.hasValue="N"===e}return e.prototype.observe=function(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}},e.prototype.do=function(e,t,n){var r=this.kind;switch(r){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return n&&n()}},e.prototype.accept=function(e,t,n){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,n)},e.prototype.toObservable=function(){var e=this.kind;switch(e){case"N":return ie(this.value);case"E":return oe(this.error);case"C":return Z()}throw new Error("unexpected notification kind value")},e.createNext=function(t){return"undefined"!=typeof t?new e("N",t):e.undefinedValueNotification},e.createError=function(t){return new e("E",void 0,t)},e.createComplete=function(){return e.completeNotification},e.completeNotification=new e("C"),e.undefinedValueNotification=new e("N",void 0),e}(),Bo=(function(){function e(e,t){void 0===t&&(t=0),this.scheduler=e,this.delay=t}return e.prototype.call=function(e,t){return t.subscribe(new Bo(e,this.scheduler,this.delay))},e}(),function(e){function t(t,n,r){void 0===r&&(r=0);var i=e.call(this,t)||this;return i.scheduler=n,i.delay=r,i}return j(t,e),t.dispatch=function(e){var t=e.notification,n=e.destination;t.observe(n),this.unsubscribe()},t.prototype.scheduleMessage=function(e){var n=this.destination;n.add(this.scheduler.schedule(t.dispatch,this.delay,new Uo(e,this.destination)))},t.prototype._next=function(e){this.scheduleMessage(Do.createNext(e))},t.prototype._error=function(e){this.scheduleMessage(Do.createError(e)),this.unsubscribe()},t.prototype._complete=function(){this.scheduleMessage(Do.createComplete()),this.unsubscribe()},t}(po)),Uo=function(){function e(e,t){this.notification=e,this.destination=t}return e}(),Fo=function(e){function t(t,n,r){void 0===t&&(t=Number.POSITIVE_INFINITY),void 0===n&&(n=Number.POSITIVE_INFINITY);var i=e.call(this)||this;return i.scheduler=r,i._events=[],i._infiniteTimeWindow=!1,i._bufferSize=t<1?1:t,i._windowTime=n<1?1:n,n===Number.POSITIVE_INFINITY?(i._infiniteTimeWindow=!0,i.next=i.nextInfiniteTimeWindow):i.next=i.nextTimeWindow,i}return j(t,e),t.prototype.nextInfiniteTimeWindow=function(t){var n=this._events;n.push(t),n.length>this._bufferSize&&n.shift(),e.prototype.next.call(this,t)},t.prototype.nextTimeWindow=function(t){this._events.push(new Vo(this._getNow(),t)),this._trimBufferThenGetEvents(),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){var t,n=this._infiniteTimeWindow,r=n?this._events:this._trimBufferThenGetEvents(),i=this.scheduler,o=r.length;if(this.closed)throw new wo;if(this.isStopped||this.hasError?t=ho.EMPTY:(this.observers.push(e),t=new Co(this,e)),i&&e.add(e=new Bo(e,i)),n)for(var a=0;a<o&&!e.closed;a++)e.next(r[a]);else for(var a=0;a<o&&!e.closed;a++)e.next(r[a].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),t},t.prototype._getNow=function(){return(this.scheduler||Lo).now()},t.prototype._trimBufferThenGetEvents=function(){for(var e=this._getNow(),t=this._bufferSize,n=this._windowTime,r=this._events,i=r.length,o=0;o<i&&!(e-r[o].time<n);)o++;return i>t&&(o=Math.max(o,i-t)),o>0&&r.splice(0,o),r},t}(So),Vo=function(){function e(e,t){this.time=e,this.value=t}return e}(),Ho=function(){var e=new Fo(1),t=e.next.bind(e);return e.next=function(e){var n=function(){var e=(new Date).getTime(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return("x"==t?n:3&n|8).toString(16)});return t};e.uuid||(e.uuid=n()),e.time||(e.time=(new Date).getTime()),t(e)},e.hasObservers=function(){if(this.closed)throw new Error;return this.observers.length>0},e.complete=function(){},e.error=function(e){this.observers.forEach(function(t){t.isStopped=!1,t.onError(e)})},e.unsubscribe=function(e){this.observers.splice(e,1)},e.unsubscribeAll=function(){this.observers.splice(0,this.observers.length)},e.clean=function(){this._events=[],this.observers=[]},e.dispose=function(){this.unsubscribe()},e},Go=Ho,qo=function(){function e(t){se(this,e),this.node=t,this.subscriptions=[],this.publications=new ho}return ce(e,[{key:"hasSubscription",value:function(e){return this.subscriptions.filter(function(t){return t.channel===e}).length>0}},{key:"publish",value:function(e){this.publications.add(e)}},{key:"makeCallbackWithNoReplay",value:function(e,t){t.node.intervals||(t.node.intervals=[]),t.node.ids||(t.node.ids=[]);var n=function(t){return t.intervals[e.name]},r=function(t,n){t.intervals[e.name]=n},i=function(e){return e._events.length>0?e._events[0].time:1},o=function(t){return t.ids[e.name]},a=function(t,n){t.ids[e.name]=n},s=function(e){return e._events.length>0?e._events[0].uuid:null},u=function(){var u=i(e),c=n(t.node),l=s(e),h=o(t.node);return!c||c<u||c===u&&h!=l?(r(t.node,u),a(t.node,l),t.apply(this,arguments)):void r(t.node,u)}.bind(this);return u.node=t.node,u}},{key:"subscribe",value:function(e,t,n){if(!this.hasSubscription(e)){var r,i=t;n===!1&&(i=this.makeCallbackWithNoReplay(e,t));var o=this._firstInstanceOfObserver(i.node,e);o===-1?(r=e.subscribe(i),o=e.observers.length-1):r=e.observers[o],r.node=i.node;var a={channel:e,observer:r,subscription:r};this.subscriptions.push(a)}}},{key:"unsubscribe",value:function(e){for(var t=this.subscriptions.length-1;t>=0;t--){var n=this.subscriptions[t],r=n.channel,i=n.observer,o=r.observers.indexOf(i);o>=0&&(e!==!0&&r.name.match(/\b__bridge_/)||r.unsubscribe(o))}this.publications.unsubscribe()}},{key:"_firstInstanceOfObserver",value:function(e,t){for(var n=-1,r=0;r<t.observers.length;r++)if(t.observers[r].node===e){n=r;break}return n}}]),e}(),zo="__bridge_ch_featureflag",Wo="featureFlagChangedCallback",Ko=new Map,Yo=function(){function e(t){ge(this,e),this._featureCollection={},this._conector=t.ComponentConnector}return me(e,[{key:"value",value:function(e){var t=e.key,n=e.defaultValue,r=e.value,i=this._featureCollection;return i.hasOwnProperty(t)&&i[t].hasOwnProperty("value")?i[t].value:i.hasOwnProperty(t)&&i[t].hasOwnProperty("defaultValue")?i[t].defaultValue:void 0!==r?r:n}},{key:"extend",value:function(e){return de(this._featureCollection,e),this._publish()}},{key:"register",value:function(e){var t=this;return Object.entries(e).map(function(e){var t=he(e,2),n=t[0],r=t[1].defaultValue;return le({},n,r)}).forEach(function(e){return de(t._featureCollection,e)}),this._publish()}},{key:"update",value:function(e){return this.extend(e.features)}},{key:"subscribe",value:function(e){var t=this;if("function"==typeof e){var n=this._conector.manager.get(zo);this._conector.getSubscriptor(this).subscribe(n,function(){return e(t)})}return this}},{key:"_publish",value:function(){var e=this._conector.manager.get(zo);return e.next(new CustomEvent(zo,{data:this.collection})),this}},{key:"collection",get:function(){return JSON.parse(JSON.stringify(this._featureCollection))}}]),e}(),Qo=Hi.externalEventsCodes,Jo=function(){this.channels={}};Jo.prototype={channels:null,get:function(e){var t=this.channels[e];return null==t&&(t=this.create(e)),t},getUnsafe:function(e){return this.channels[e]},create:function(e){var t=Go();return t.name=e,this.channels[e]=t,t},remove:function(e){delete this.channels[e]},unregisterAllSubscriptors:function(){this.ComponentConnector.subscriptors.forEach(function(e){e.subscriptions.forEach(function(e){return e.subscription.unsubscribe()})})},cleanAllChannels:function(){for(var e in this.channels)this.channels.hasOwnProperty(e)&&this.channels[e].clean()},removeAllChannels:function(){for(var e in this.channels)this.channels.hasOwnProperty(e)&&delete this.channels[e]},has:function(e){return null!=this.channels[e];
}};var $o=function(){function e(){_e(this,e),this.manager=null,this.subscriptors=null,this.bridgeChannelsPrefix=null,this.manager=new Jo,this.subscriptors=new Map,this.bridgeChannelsPrefix=/__bridge_(?!ch)/}return ke(e,[{key:"getSubscriptor",value:function(e){var t=this.subscriptors.get(e);return t||(t=new qo(e),this.subscriptors.set(e,t)),t}},{key:"register",value:function(e,t){e&&t&&(this._registerOutConnections(e,t.out),this._registerInConnections(e,t.in))}},{key:"progressiveRegister",value:function(e,t){e&&t&&(this._registerOutConnections(e,t.out),this._updateInConnections(e,t.in))}},{key:"_registerInConnections",value:function(e,t){var n,r,i;if(t)for(n in t)r=t[n].bind,i=t[n].previousState||!1,this.addSubscription(n,e,r,i)}},{key:"addSubscription",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this._wrapCallbackWithNode(t,n),o=this.manager.get(e);if(o){var a=this.getSubscriptor(t);a.subscribe(o,i,r)}}},{key:"_updateInConnections",value:function(e,t){var n,r,i;if(t)for(n in t)r=t[n].bind,i=t[n].previousState||!1,this.updateSubscription(n,e,r,i)}},{key:"updateSubscription",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.getSubscriptor(t);if(this.isActiveBridgeChannel(e)||!this.isActiveBridgeChannel(e)&&!this.hasSubscriptions(i,e)){var o=this.manager.get(e),a=this._wrapCallbackWithNode(t,n);i.subscribe(o,a,r)}}},{key:"_wrapCallbackWithNode",value:function(e,t){var n=this.wrapCallback(e,t);return n.node=e,n}},{key:"_hasPublisher",value:function(e,t,n,r){var i=!1;return e.publications._subscriptions&&e.publications._subscriptions.forEach(function(e){e.node===t&&e.channelName===n&&e.eventName===r&&(i=!0)}),i}},{key:"_registerOutConnections",value:function(e,t){var n,r;if(t)for(n in t)r=t[n].bind,this.addPublication(n,e,r,t[n])}},{key:"addPublication",value:function(e,t,n,r){if(this.isBridgeChannel(e))console.warn("Forbidden operation. You are trying to write to a private channel (".concat(e,")."));else{var i=this.getSubscriptor(t),o=this.manager.get(e),a=this._hasPublisher(i,t,e,n);a||i.publish(this.wrapEvent(t,n,o,r))}}},{key:"publish",value:function(e,t){if(this.isBridgeChannel(e))console.warn("Forbidden operation. You are trying to write to a private channel (".concat(e,")."));else{var n=this.manager.get(e),r="".concat(e,"-publish");n.next(new CustomEvent(r,{detail:t}))}}},{key:"unsubscribe",value:function(e,t){if(e&&t){var n=Array.isArray(e)?e:[e],r=this.subscriptors.get(t),i=r.subscriptions,o=function(e){return n.includes(e.channel.name)},a=i.filter(o);a.forEach(function(e){e.subscription.unsubscribe();var t=r.subscriptions.findIndex(function(t){return t===e});r.subscriptions.splice(t,1)})}}},{key:"unregister",value:function(e,t){if(e){var n=this.subscriptors.get(e);n&&(n.unsubscribe(t),this.subscriptors.delete(e))}}},{key:"unregisterAllSubscriptors",value:function(e){this.subscriptors.forEach(function(t){t.subscriptions.forEach(function(t){return t.subscription.unsubscribe(e)})})}},{key:"sleep",value:function(e){if(e){this.subscriptors.get(e)}}},{key:"wrapCallback",value:function(e,t){var n=function(n){"function"==typeof t?t(n.detail):"function"==typeof e[t]?e[t](n.detail):e[t]=n.detail};return n}},{key:"_isEventAtTarget",value:function(e){var t=Event.AT_TARGET||Event.prototype.AT_TARGET;return e.eventPhase===t}},{key:"wrapEvent",value:function(e,t,n,r){var i=Qo.AFTER_PUBLISH,o=Qo.NAV_REQUEST,a=Qo.ROUTER_BACKSTEP,s=Qo.TRACK_EVENT,u=Qo.LOG_EVENT,c=K(e,t);Ko.has(e)&&(c=c.pipe(X(function(){return Ko.get(e)})));var l=c.subscribe(function(e){if(this._isEventAtTarget(e)){if(n.next(e),Ti.emit(i,e),r&&r.link){var t=be({},r.link);r.link.page&&r.link.page.hasOwnProperty("bind")&&(t.page=e.detail[r.link.page.bind]),Ti.emit(o,{event:e,detail:t})}r&&r.backStep&&Ti.emit(a,{event:e,detail:{}}),r&&r.analytics&&Ti.emit(s,{event:e,detail:r.analytics}),r&&r.log&&Ti.emit(u,{event:e,detail:r.log}),this.wrapEventHandler&&this.wrapEventHandler(e,r,n)}}.bind(this));return l.node=e,l.eventName=t,l.channelName=n.name,l}},{key:"createEvent",value:function(e,t){var n=new Event(e);return n.detail={value:t},n}},{key:"isActiveBridgeChannel",value:function(e){return this.isBridgeChannel(e)&&this.manager.getUnsafe(e)}},{key:"isBridgeChannel",value:function(e){return this.bridgeChannelsPrefix.test(e)}},{key:"hasSubscriptions",value:function(e,t){return e.subscriptions.filter(function(e){return e.channel.name===t}).length>0}}]),e}(),Xo=$o,Zo=function(){function e(t,n){we(this,e),this.name="",this.pattern="",this.regexp=null,this.redirectPage=null,this.isAccessible=!0,this.name=t,this.pattern=n;var r=n.replace(e.PARAM,"([^/]+)").replace(e.TRAILING_SLASHES,"/*");this.regexp=new RegExp("^"+r+"$");for(var i,o=[];null!==(i=e.PARAM.exec(n));)o.push(i[1]);this.keys=o}return Te(e,[{key:"path",value:function t(n){n=n||{},this.params={};for(var r,t=this.pattern;null!==(r=e.PARAM.exec(this.pattern));)t=t.replace(r[0],n[r[1]]),this.params[r[1]]=n[r[1]];var i=[];for(var o in n)this.params.hasOwnProperty(o)||i.push(o+"="+encodeURIComponent(n[o]));return i.length&&(t+="?"+i.join("&")),t}},{key:"matchPath",value:function(e){return e.match(this.regexp)}},{key:"parsePath",value:function(t){var n=this.matchPath(t);if(this.params={},n)for(var r,i=1;null!==(r=e.PARAM.exec(this.pattern));)this.params[r[1]]=this._parseParam(n[i]),i++}},{key:"parseQuery",value:function(e){this.query=e;for(var t in this.query)this.query.hasOwnProperty(t)&&(this.params[t]=this.query[t])}},{key:"is404",value:function(){return this.name===e._404_PAGE_NAME}},{key:"_isNumber",value:function(e){return parseInt(e)+""===e||parseFloat(e)+""===e}},{key:"_parseParam",value:function(e){return this._isNumber(e)&&(e=+e),e}},{key:"handler",value:function(){}}]),e}();Zo.PARAM=/(?::([^\/]+))/g,Zo.TRAILING_SLASHES=/\/*$/,Zo._404_PAGE_NAME="404";var ea,ta,na,ra=function(e){function t(t,n,r){var i=e.call(this)||this;return i.parent=t,i.outerValue=n,i.outerIndex=r,i.index=0,i}return j(t,e),t.prototype._next=function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)},t.prototype._error=function(e){this.parent.notifyError(e,this),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},t}(po),ia=function(e){return function(t){return e.then(function(e){t.closed||(t.next(e),t.complete())},function(e){return t.error(e)}).then(null,B),t}},oa=Se(),aa=function(e){return function(t){for(var n=e[oa]();;){var r=n.next();if(r.done){t.complete();break}if(t.next(r.value),t.closed)break}return"function"==typeof n.return&&t.add(function(){n.return&&n.return()}),t}},sa=function(e){return function(t){var n=e[go]();if("function"!=typeof n.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return n.subscribe(t)}},ua=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e},ca=function(e){if(e&&"function"==typeof e[go])return sa(e);if(ua(e))return jo(e);if(Pe(e))return ia(e);if(e&&"function"==typeof e[oa])return aa(e);var t=U(e)?"an invalid object":"'"+e+"'",n="You provided "+t+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.";throw new TypeError(n)},la=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return j(t,e),t.prototype.notifyNext=function(e,t,n,r,i){this.destination.next(t)},t.prototype.notifyError=function(e,t){this.destination.error(e)},t.prototype.notifyComplete=function(e){this.destination.complete()},t}(po),ha=function(){function e(e,t){void 0===t&&(t=Number.POSITIVE_INFINITY),this.project=e,this.concurrent=t}return e.prototype.call=function(e,t){return t.subscribe(new fa(e,this.project,this.concurrent))},e}(),fa=function(e){function t(t,n,r){void 0===r&&(r=Number.POSITIVE_INFINITY);var i=e.call(this,t)||this;return i.project=n,i.concurrent=r,i.hasCompleted=!1,i.buffer=[],i.active=0,i.index=0,i}return j(t,e),t.prototype._next=function(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)},t.prototype._tryNext=function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(e){return void this.destination.error(e)}this.active++,this._innerSub(t,e,n)},t.prototype._innerSub=function(e,t,n){var r=new ra(this,t,n),i=this.destination;i.add(r);var o=Oe(this,e,void 0,void 0,r);o!==r&&i.add(o)},t.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},t.prototype.notifyNext=function(e,t,n,r,i){this.destination.next(t)},t.prototype.notifyComplete=function(e){var t=this.buffer;this.remove(e),this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},t}(la),pa=function(){function e(e,t){this.compare=e,this.keySelector=t}return e.prototype.call=function(e,t){return t.subscribe(new va(e,this.compare,this.keySelector))},e}(),va=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.keySelector=r,i.hasKey=!1,"function"==typeof n&&(i.compare=n),i}return j(t,e),t.prototype.compare=function(e,t){return e===t},t.prototype._next=function(e){var t;try{var n=this.keySelector;t=n?n(e):e}catch(e){return this.destination.error(e)}var r=!1;if(this.hasKey)try{var i=this.compare;r=i(this.key,t)}catch(e){return this.destination.error(e)}else this.hasKey=!0;r||(this.key=t,this.destination.next(e))},t}(po),da=function(){function e(){qe(this,e),this.navStack=[],this.skipNav={}}return We(e,[{key:"addSkipNavigation",value:function(e){e.skipHistory!==!0&&e.skipHistory!==!1||(this.skipNav["".concat(e.from,":").concat(e.to)]=e.skipHistory)}},{key:"_reverseNavigation",value:function(e){return{from:e.to,to:e.from}}},{key:"isSkipNavigation",value:function(e){return this.skipNav["".concat(e.from,":").concat(e.to)]===!0}},{key:"lastNavigation",value:function(){var e,t,n=this.navStack.length;return 1===n?t=this.navStack[0]:n>1&&(t=this.navStack[n-1],e=this.navStack[n-2]),this.createNavigation(e,t)}},{key:"createRoute",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{page:e,params:t}}},{key:"createNavigation",value:function(e,t){return{from:e?e.page:void 0,to:t?t.page:void 0}}},{key:"push",value:function(e){this.top()&&this.top().page===e.page||this.navStack.push(e)}},{key:"replace",value:function(e){this.top()&&this.top().page===e.page||(this.navStack[this.navStack.length-1]=e)}},{key:"pop",value:function(){return this.navStack.pop()}},{key:"top",value:function(){return this.navStack.length>0?this.navStack[this.navStack.length-1]:void 0}},{key:"isBackwardNavigation",value:function(e){var t=this.lastNavigation();return t&&e.from===t.to&&e.to===t.from}},{key:"update",value:function(e,t){var n=this.createNavigation(e,t);if(this.isBackwardNavigation(n)){for(;this.isSkipNavigation(this._reverseNavigation(this.lastNavigation()));)this.pop();this.pop()}else this.push(t);return this.top()}},{key:"clear",value:function(){this.navStack=[]}},{key:"replaceRoute",value:function(e){this.navStack.length>0?this.navStack[this.navStack.length-1]=e:this.push(e)}},{key:"clearUntil",value:function(e){if(this.navStack.find(function(t){return t.page===e})){var t=null;do t=this.navStack.pop();while(t&&t.page!=e)}}},{key:"length",get:function(){return this.navStack.length}}]),e}(),ga=ho.EMPTY,ya=Hi.externalEventsCodes,ma=null,ba=!1,_a={},Ea=function(e){function t(){var e;return Xe(this,t),e=tt(this,ot(t).call(this)),e._currentSubscription=ga,e}return at(t,e),et(t,[{key:"add",value:function(e){this.closed||("function"==typeof e&&(e=new ho(e)),this._currentSubscription&&(this.remove(this._currentSubscription),this._currentSubscription.unsubscribe(),this._currentSubscription=null),rt(ot(t.prototype),"add",this).call(this,this._currentSubscription=e))}}]),t}(ho),ka=function(){function e(){var t=this;Xe(this,e);var n=ya.TEMPLATE_TRANSITION_END;return ma||(ma=this),this.navigationStack=this._createNavigationStack(),Ti.on(n,function(){t.isNavigationInProgress=!1}),ma}return et(e,[{key:"_createNavigationStack",value:function(){return new da}},{key:"handler",value:function(e){}},{key:"addRoute",value:function(e,t){return this.routes[e]=new Zo(e,t),this.routes[e]}},{key:"addRoutes",value:function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=this.addRoute(n,e[n]));return t}},{key:"addSkipNavigations",value:function(e){for(var t=0;t<e.length;t++)this.navigationStack.addSkipNavigation(e[t])}},{key:"_getHashPath",value:function(){return location.hash.replace(e.HASH_PREFIX,"/").replace(e.EMPTY,"/")}},{key:"_observeHashChange",value:function(){return K(window,"hashchange").pipe(W(this._getHashPath),He(this._getHashPath()))}},{key:"_getURLPath",value:function(){return location.pathname.replace(e.PATH_PREFIX,"/")}},{key:"_observeStateChange",value:function(){return Ue(K(window,"popstate"),K(window,"pushstate")).pipe(W(this._getURLPath),He(this._getURLPath()))}},{key:"matchRoute",value:function(e){var t,n=e.split("?"),r=Ke(n,2),i=r[0],o=r[1];o=this._parseQuery(o);for(var a in this.routes)if(this.routes.hasOwnProperty(a)&&(t=this.routes[a],(!t.is404()||t.isAccessible)&&t.matchPath(i)))return t.parsePath(i),t.parseQuery(o),t}},{key:"_parseQuery",value:function(e){var t={};if(e){var n=e.split("&");if(n){var r,i,o,a=n.length;for(o=0;o<a;o++){var s=n[o].split("="),u=Ke(s,2);r=u[0],i=u[1],t[r]=decodeURIComponent(i)}}}return t}},{key:"_setup404",value:function(){var e=this.routes[Zo._404_PAGE_NAME];if(e&&""!==e.pattern){var t=this.getRouteWithPattern(e.pattern);e.redirectPage=t?t.name:e.name,e.isAccessible=!t}return e}},{key:"getRouteWithPattern",value:function(e){for(var t in this.routes)if(this.routes.hasOwnProperty(t)){var n=this.routes[t];if(!n.is404()&&n.pattern===e)return n}return null}},{key:"start",value:function(){var e=this;if(!ea){var t=new Ea;na=this._setup404();var n=this.useHistory?this._observeStateChange():this._observeHashChange(),r=n.pipe(Ge(),W(this.matchRoute.bind(this)));r.forEach(function(n){if(e.hashIsDirty)e.hashIsDirty=!1;else if(n){var r=e.currentRoute?e.currentRoute.name:void 0,i=e.currentRoute?e.currentRoute.params:void 0,o=e.navigationStack.createRoute(r,i),a=e.navigationStack.createRoute(n.name,n.params),s=e.navigationStack.update(o,a).page;if(s!==a.page)return void e.go(s,void 0,!1);ta=n;var u=new ho(function(){return e.currentRoute});t.add(u),e.currentRoute.handler(),e.handler(e.currentRoute)}else na&&na.redirectPage&&e.goReplacing(na.redirectPage)}),ea=new ho(r,t)}return ea}},{key:"stop",value:function(){ea&&(ea.unsubscribe(),ea=null),this.isNavigationInProgress=!1}},{key:"destroy",value:function(){this.stop(),this.routes={}}},{key:"getPath",value:function(e,t){var n=this.routes[e];return n?n.path(t):void console.error("Wrong route name: %s, valid route names: %s",e,Object.keys(this.routes).join(", "))}},{key:"newNavigation",value:function(e){return{from:this.currentRoute?this.currentRoute.name:void 0,to:e}}},{key:"reverseNavigation",value:function(e){return{from:e.to,to:e.from}}},{key:"go",value:function(t,n,r,i){if(!this.isNavigationInProgress){if(void 0!==i){var o=this.newNavigation(t),a=this.reverseNavigation(o);a.skipHistory=i,this.navigationStack.addSkipNavigation(a)}var s=t.replace(e.LTRIM_SLASH,""),u=this.getPath(s,n);u!==this._getHashPath()&&(this.isNavigationInProgress=!0,this.updatePathInBrowser(u,r))}}},{key:"back",value:function(){var e={};if(this.navigationStack.length>1){for(var t=this.navigationStack.pop(),n=t,r=this.getLastRoute();this.navigationStack.isSkipNavigation({from:n.page,to:r.page})&&this.navigationStack.length>1;)n=this.navigationStack.pop(),this.navigationStack.length>0&&(r=this.getLastRoute());var i=r.page,o=r.params;e.from=t,e.to=r,this.go(i,o)}else e.from=this.getLastRoute(),e.to=this.getLastRoute();return e}},{key:"updatePathInBrowser",value:function(e,t){this.useHistory?t?this.historyReplaceState(e):this.historyPushState(e):t?this.locationReplace(e):this.locationHash(e)}},{key:"goReplacing",value:function(e,t){this.go(e,t,!0)}},{key:"historyReplaceState",value:function(e){history.replaceState(null,null,e)}},{key:"historyPushState",value:function(e){history.pushState(null,null,e)}},{key:"locationReplace",value:function(e){location.replace("#!"+e)}},{key:"locationHash",value:function(e){location.hash="#!"+e}},{key:"getLastRoute",value:function(){return this.navigationStack.top()}},{key:"init",value:function(){this._clearStack()}},{key:"_clearStack",value:function(){this.navigationStack.clear()}},{key:"clearStackUntil",value:function(e){this.navigationStack.clearUntil(e)}},{key:"useHistory",set:function(t){e.SUPPORTS_HISTORY_API&&(ba=t)},get:function(){return ba}},{key:"routes",set:function(e){_a=e},get:function(){return _a}},{key:"currentRoute",get:function(){return ta},set:function(e){ta=e}}]),e}();ka.SUPPORTS_HISTORY_API=window.history&&"pushState"in window.history,ka.PARAM=/(?::([^\/]+))/g,ka.LTRIM_SLASH=/^\/(\b)/,ka.EMPTY=/^$/,ka.HASH_PREFIX=/^#!?\/*/,ka.PATH_PREFIX=/^\/*/,ka.isNavigationInProgress=!1,ka.hashIsDirty=!1;var wa=Hi.externalEventsCodes,Ca=function(e,t){return function(){if(--e<1)return t()}},Ta=function(){function e(){ut(this,e)}return lt(e,[{key:"_importElement",value:function(e,t,n){var r=document.createElement("link");r.rel="import",r.href=e+t,r.onload=n,r.onerror=n,r.setAttribute("async",""),document.head.appendChild(r)}},{key:"_importElementPromise",value:function(e,t){var n=this;return new Promise(function(r){n._importElement(e,t,r)})}},{key:"loadBundleForTemplate",value:function(e,t,n){var r=this;return new Promise(function(i){var o=function(){n&&n.call(r),i()};r._importElement(e,t+".html",o)})}},{key:"loadComponent",value:function(e,t,n){var r=this,i=wa.BEFORE_IMPORT,o=wa.AFTER_IMPORT;return new Promise(function(a){var s=function(){n&&n.call(r),a()},u=e;if(Array.isArray(u)||(u=[e]),0===u.length)return void s();Ti.emit(i);for(var c=Ca(u.length,function(){Ti.emit(o),s()}),l=0;l<u.length;l++){var h=u[l];r._importElement(t,h.spec.path,c)}})}},{key:"loadComponentByPriority",value:function(e,t,n){var r=this,i=wa.BEFORE_IMPORT,o=wa.AFTER_IMPORT,a=e;if(Array.isArray(a)||(a=[e]),0===a.length)return void(n&&n.call(this));var s=this._createPriorityLists(a);Ti.emit(i),this._chainElementLoading(t,s,0).then(function(){Ti.emit(o),n&&n.call(r)})}},{key:"_createSortedArratByPriorityAndUniqueElements",value:function(e){return e.sort(function(e,t){var n=e.priority||1e3,r=t.priority||1e3;return n===r?e.spec.path<=t.spec.path?-1:1:n-r}),e.filter(function(e,t,n){return 0===t||e.spec.path!==n[t-1].spec.path})}},{key:"_createPriorityLists",value:function(e){for(var t=this._createSortedArratByPriorityAndUniqueElements(e),n=t[0].priority,r=[[]],i=0,o=0;o<t.length;o++){var a=t[o];a.priority===n?r[i].push(a):(n=a.priority,r.push([]),i=r.length-1,r[i].push(a))}return r}},{key:"_chainElementLoading",value:function(e,t,n){var r=this,i=[];if(t.length===n)return Promise.resolve();for(var o=0;o<t[n].length;o++)i.push(this._importElementPromise(e,t[n][o].spec.path));var a=n+1;return Promise.all(i).then(function(){return r._chainElementLoading(e,t,a)})}}]),e}(),Sa=Ta,Pa=Hi.renderEngines,Oa=function(e){function t(e){var n;return ft(this,t),n=dt(this,yt(t).call(this)),n.type="",n.spec=null,n.zone=null,n.node=null,n.fixed=null,n.priority=null,n.connections=null,n.spec=e,n.type=e.type,n.zone=e.zone,n.fixed=e.fixed,n.priority=e.priority,n.node=n.spec.node?n.spec.node:n.createElement(n.spec.tagName),n.connections=e.connections,n}return mt(t,e),vt(t,[{key:"setProps",value:function(){var e=this.spec;if(e.connections&&e.connections.ignoreAttr)for(var t=0;t<e.connections.ignoreAttr.length;t++){var n=e.connections.ignoreAttr[t];delete e.properties[n]}this.setAttrs(this.node,e.properties)}},{key:"isUnresolved",value:function(){return this.node.tagName.indexOf("-")>-1&&this.node.constructor===HTMLElement}},{key:"isLitElement",value:function(){return this.spec.render&&this.spec.render===Pa.litElement}}]),t}(zi),Na=function(e){function t(){var e,n,r;Et(this,t);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return Ct(r,(n=r=Ct(this,(e=St(t)).call.apply(e,[this].concat(o))),r.children=[],r.fixedChildren=[],r.type="TEMPLATE",n))}return Pt(t,e),wt(t,[{key:"getZone",value:function(e){var t,n=this.node;return t=e?n.$&&n.$[e]?n.$[e]:n.querySelector("#"+e):n,t||n}},{key:"cache",value:function(){this._setAttribute("state","cached")}},{key:"activate",value:function(){this._setAttribute("state","active")}},{key:"deactivate",value:function(){this._setAttribute("state","inactive")}},{key:"native",value:function(){this._setAttribute("state","native")}},{key:"resetNextNavigation",value:function(){this._getTemplate(this.node)._nextNavigation=void 0}},{key:"_setAttribute",value:function(e,t){var n=this._getTemplate(this.node);n.setAttribute(e,t)}},{key:"_getTemplate",value:function(e){var t=e.tagName,n=t.toLowerCase().endsWith("-page");return n?this._getCellsTemplateFromShadowRootChildNodes(e):e}},{key:"_getCellsTemplateFromShadowRootChildNodes",value:function(e){return Array.from(e.shadowRoot.childNodes).find(function(e){return e&&e.tagName&&e.tagName.toLowerCase().indexOf("cells-template")!==-1})}},{key:"append",value:function(e){if(e){void 0===e.length&&(e=[e]);var t=e.filter(function(e){return e.fixed!==!0}),n=e.filter(function(e){return e.fixed===!0});this.fixedChildren=this.fixedChildren.concat(n),this.children=this.children.concat(e);for(var r=[],i=0;i<t.length;i++){var o=t[i];o.node.setAttribute("data-select",o.zone),o.node.setAttribute("slot",o.zone),"object"!==_t(r[o.zone])&&(r[o.zone]=this.getZone(o.zone)),r[o.zone].appendChild(o.node)}}}},{key:"config",value:function(e){var t=e.name,n=e.template,r=n.id,i=n.name;this.name=t,this.node.id=r,this.node.name=i,this.setProps()}}]),t}(Oa),Ra=Hi.bindingCodes,Aa=Hi.externalEventsCodes,Ia=function(){function e(t){Nt(this,e),this.cache={},this.templates={},this.selected="",this.locations=[],this.size=0,this.fixedTemplates=["__cross"];var n=t||{},r=n.persistentPages||[];this.viewLimit=n.viewLimit&&n.viewLimit>=1?n.viewLimit:3,this.fixedTemplates=this.fixedTemplates.concat(r),this.maxSize=this.viewLimit+this.fixedTemplates.length}return At(e,[{key:"create",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.get(e);return r||(r=this._createFromJSON(e,t),this._storeTemplate(e,r,n)),r}},{key:"createFromComponent",value:function(e,t){var n=this._createCellsTemplate(e,{tagName:t});return this._storeTemplate(e,n),n}},{key:"register",value:function(e,t){var n=this._createFromHTMLElement(e,t);return this._storeTemplate(e,n),n}},{key:"_storeTemplate",value:function(e,t,n){var r=t.node;if(n){var i=this.fixedTemplates.indexOf(e)===-1;if(i){this.fixedTemplates.push(e),this.maxSize++;var o=this.maxSize===this.fixedTemplates.length;o&&(this.maxSize+=this.viewLimit)}}if(this.size>=this.maxSize){var a=this._getOlderRemovableTemplate();a?this.removeTemplate(a):console.warn("No space left in template cache for template ",e)}this.locations.push(e),this.cache[e]=t,this.templates[e]=r,this.size++}},{key:"_getOlderRemovableTemplate",value:function(){for(var e,t=!1,n=0;!t&&n<this.locations.length;n++){var r=this.fixedTemplates.indexOf(this.locations[n])==-1;r&&(e=this.locations[n],t=!0)}return e}},{key:"_createFromHTMLElement",value:function(e,t){var n=this._createCellsTemplate(e,{node:t});return n}},{key:"_createFromJSON",value:function(e,t){var n=this._createCellsTemplate(e,t);return n}},{key:"_createCellsTemplate",value:function(e,t){return new Na(e,t)}},{key:"get",value:function(e){return this.cache[e]}},{key:"getNode",value:function(e){return this.templates[e]}},{key:"parseTemplateName",value:function(e){return e}},{key:"parseTemplateId",value:function(e){return"cells-template-"+e.replace(/\./g,"-")}},{key:"select",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"always",i=Aa.TEMPLATE_TRANSITION_END,o=Ra.CURRENTVIEW,a=Ra.UI,s=this.get(e),u=this.cache;for(var c in u)u.hasOwnProperty(c)&&(c===this.selected?(t=c,u[c].deactivate()):e!==c&&u[c].cache());this.selected=e,s.activate(),n&&r!==o&&r!==a&&(n.updateAppContext(t,e),n.initPrivateChannel(t,e)),Ti.emit(i,s)}},{key:"removeTemplate",value:function(e){if(this.templates[e]){var t=document.querySelector("#"+this.templates[e].id),n=this.locations.indexOf(e);this.locations.splice(n,1),t.parentNode.removeChild(t),delete this.templates[e],delete this.cache[e],this.size--}}},{key:"removeTemplates",value:function(e,t){for(var n in this.templates)this.templates.hasOwnProperty(n)&&n!==e&&n!==t&&this.removeTemplate(n)}},{key:"removeTemplateChildrens",value:function(e){var t=this.templates[e];if(t&&t.children)for(var n=t.children.length-1;n>=0;n--)t.removeChild(t.children[n])}}]),e}(),xa=Ia,La=function(){function e(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return e.prototype=Object.create(Error.prototype),e}(),Ma=La,ja=function(){function e(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return e.prototype=Object.create(Error.prototype),e}(),Da=ja,Ba=function(){function e(e){if(this.total=e,this.total<0)throw new Da}return e.prototype.call=function(e,t){return t.subscribe(new Ua(e,this.total))},e}(),Ua=function(e){function t(t,n){var r=e.call(this,t)||this;return r.total=n,r.count=0,r}return j(t,e),t.prototype._next=function(e){var t=this.total,n=++this.count;n<=t&&(this.destination.next(e),n===t&&(this.destination.complete(),this.unsubscribe()))},t}(po),Fa=function(){function e(e){this.defaultValue=e}return e.prototype.call=function(e,t){return t.subscribe(new Va(e,this.defaultValue))},e}(),Va=function(e){function t(t,n){var r=e.call(this,t)||this;return r.defaultValue=n,r.isEmpty=!0,r}return j(t,e),t.prototype._next=function(e){this.isEmpty=!1,this.destination.next(e)},t.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},t}(po),Ha=function(){function e(e){this.errorFactory=e}return e.prototype.call=function(e,t){return t.subscribe(new Ga(e,this.errorFactory))},e}(),Ga=function(e){function t(t,n){var r=e.call(this,t)||this;return r.errorFactory=n,r.hasValue=!1,r}return j(t,e),t.prototype._next=function(e){this.hasValue=!0,this.destination.next(e)},t.prototype._complete=function(){if(this.hasValue)return this.destination.complete();var e=void 0;try{e=this.errorFactory()}catch(t){e=t}this.destination.error(e)},t}(po),qa=function(){function e(t){Dt(this,e),this.componentConnector=t.ComponentConnector,this.privateChannels=new Set}return Ut(e,[{key:"getAppContextChannelName",value:function(){return"__bridge_app"}},{key:"getCancelledBackNavigationChannelName",value:function(){return"__bridge_cancelled_back_navigation"}},{key:"getPrivateChannelPrefix",value:function(){return"__bridge_page_"}},{key:"getEventChannelPrefix",value:function(){return"__bridge_evt_"}},{key:"getBridgeChannelPrefix",value:function(){return"__bridge_ch_"}},{key:"getPostMessageChannelPrefix",value:function(){return"__bridge_post_message_"}},{key:"getBridgeChannel",value:function(e){return this.componentConnector.manager.get(this.getBridgeChannelPrefix()+e)}},{key:"getIdleCallbackChannel",value:function(){var e=yo.create(function(e){return e.next(!0)});return e.pipe(jt())}},{key:"getAppContextChannel",value:function(){return this.componentConnector.manager.get(this.getAppContextChannelName())}},{key:"getCancelledBackNavigationChannel",value:function(){return this.componentConnector.manager.get(this.getCancelledBackNavigationChannelName())}},{key:"getPrivate",value:function(e){var t=this.getPrivateChannelPrefix()+e,n=this.componentConnector.manager.get(t);return this.privateChannels.add(t),n}},{key:"getPostMessageChannel",value:function(e){var t=this.getPostMessageChannelPrefix()+e;return this.componentConnector.manager.get(t)}},{key:"initAppContextChannel",value:function(){this.getAppContextChannel()}},{key:"initCancelledBackNavigationChannel",value:function(){this.getCancelledBackNavigationChannel()}},{key:"initPrivateChannel",value:function(e,t){this.publishPrivatePageStatus(t,!0),e&&this.publishPrivatePageStatus(e,!1)}},{key:"publishPrivatePageStatus",value:function(e,t){var n=this.getPrivate(e),r=this.componentConnector.createEvent("page-load",t);n.next(r)}},{key:"updateAppContext",value:function(e,t){var n=this.componentConnector.createEvent("app-context",{currentPage:t,fromPage:e});this.getAppContextChannel().next(n)}},{key:"publishCancelledBackNavigation",value:function(e){var t=this.componentConnector.createEvent("back-nav-cancelled",e);this.getCancelledBackNavigationChannel().next(t)}},{key:"isPrivateChannel",value:function(e){return 0===e.indexOf(this.getPrivateChannelPrefix())}},{key:"isActivePrivateChannel",value:function(e){return this.privateChannels.has(e)}},{key:"resetBridgeChannels",value:function(e,t){var n=Object.keys(this.componentConnector.manager.channels);n.forEach(function(e){var t=this.componentConnector.manager.get(e);t.clean(),t.unsubscribeAll()}.bind(this)),this.componentConnector.unregister(e,t),this.componentConnector.unregisterAllSubscriptors(t),this.componentConnector.manager.cleanAllChannels()}},{key:"initEventChannels",value:function(e,t){t.forEach(function(t){var n=this.getEventChannelPrefix(),r=n+t,i=this.componentConnector.manager.get(r),o=K(e,t);o.subscribe(function(e){i.next(e)})}.bind(this))}},{key:"subscribeToEvent",value:function(e,t,n){var r=this.getEventChannelPrefix(),i=r+t,o=this.componentConnector.getSubscriptor(e),a=this.componentConnector.manager.get(i);n.node=e,o.subscribe(a,n)}}]),e}(),za=qa,Wa=Hi.externalEventsCodes,Ka=function(){function e(t){Ft(this,e),this.bridge=t,this.PageManager=t.PageManager,this.ChannelManager=t.BridgeChannelManager,this.TemplateManager=t.TemplateManager}return Ht(e,[{key:"subscribeAll",value:function(){var e=this;this.ChannelManager.getBridgeChannel("config").subscribe(function(t){return e._configSubscriptor(t)}),this.ChannelManager.getBridgeChannel("locales").subscribe(function(t){return e._localesSubscriptor(t)}),this.ChannelManager.getBridgeChannel("logout").subscribe(function(t){return e._logoutSubscriptor(t)})}},{key:"_isAllowedProperty",value:function(e){return"function"!=typeof this.bridge[e]}},{key:"_configSubscriptor",value:function(e){var t=this,n=Wa.TEMPLATE_REGISTERED,r=this.TemplateManager.selected;if(e.detail){for(var i in e.detail)e.detail.hasOwnProperty(i)&&this._isAllowedProperty(i)&&(this.bridge[i]=e.detail[i]);(e.detail.app||e.detail.pagesPath)&&(this.PageManager.clear(),this.TemplateManager.removeTemplates(r,this.bridge.crossContainerId),Ti.once(n,function(){return t.TemplateManager.removeTemplate(r)}))}}},{key:"_localesSubscriptor",value:function(e){window.I18nMsg&&e.detail&&e.detail.lang&&(window.I18nMsg.lang=e.detail.lang)}},{key:"_logoutSubscriptor",value:function(){this.bridge.logout(),this.subscribeAll()}}]),e}(),Ya=Ka,Qa=function(){function e(t,n){Gt(this,e),this.componentConnector=t,this.composerEngine=n,this.segments=[],this.customGroups=[],this.normalizedCustomGroups=[]}return zt(e,[{key:"init",value:function(e){var t=this;this.initialParams=e||{},this.addParams(this.initialParams),this.componentConnector.get(this.getComposerEngineChannelName()).subscribe(function(e){return t.handleFeatureFlags(e)})}},{key:"getComposerEngineChannelName",value:function(){return"__composer_engine"}},{key:"handleFeatureFlags",value:function(e){var t=e.detail;this.addParams(t)}},{key:"addParams",value:function(e){this.addSegments(e.segments),this.addCustomGroups(e.customGroups)}},{key:"addSegments",value:function(e){var t=this;e&&e.forEach(function(e){t.segments.indexOf(e)===-1&&t.segments.push(e)})}},{key:"addCustomGroups",value:function(e){var t=this;e&&e.forEach(function(e){var n=t.customGroups.find(function(t){return t.name===e.name});n?n.isConstant||(n.value=e.value):t.customGroups.push(e)}),this.normalizedCustomGroups=this.normalizeCustomGroups(this.customGroups);
}},{key:"normalizeCustomGroups",value:function(e){var t=this;return e.map(function(e){return t.composerEngine.customGroup(e.name,JSON.stringify(e.value))})}},{key:"getPage",value:function(e){return this.composerEngine.getPageForAll(e,this.segments,this.normalizedCustomGroups)}},{key:"reset",value:function(){this.segments=[],this.customGroups=[],this.init(this.initialParams)}}]),e}(),Ja=Qa,$a=n(4),Xa=n.n($a),Za=n(1),es=n.n(Za),ts=es.a.get,ns=es.a.set,rs=Hi.monitoring.SEMAAS,is=rs.mrId,os=rs.nameSpace,as=rs.identifier,ss=rs.consumerId,us=rs.policy,cs=Hi.externalEventsCodes,ls=cs.PAGE_READY,hs=cs.PARSE_ROUTE,fs=cs.AFTER_PUBLISH,ps=cs.NAV_REQUEST,vs=cs.BEFORE_SET_ATTR_TO_NODE,ds=cs.AFTER_SET_ATTR_TO_NODE,gs=cs.BEFORE_CREATE_NODE,ys=cs.AFTER_CREATE_NODE,ms=cs.BEFORE_IMPORT,bs=cs.AFTER_IMPORT,_s=cs.PAGE_REQUEST,Es=cs.PAGE_RESPONSE,ks=cs.DATA_LOAD,ws=cs.TEMPLATE_TRANSITION_END,Cs=cs.TRACK_EVENT,Ts=cs.TEMPLATE_REGISTERED,Ss=cs.ROUTER_BACKSTEP,Ps=cs.LOG_EVENT,Os=function(){function e(t){Kt(this,e),this.bridge=null,this.application=null;var n=t.semaas,r=void 0===n?{}:n,i=t.logs;if(i){var o=!1,a=this.getApplicationConfiguration(r);if(this.application=this.initilizeSEMaaSAdapter(a),o){var s=this.getBridgeConfiguration(r);this.bridge=this.initilizeSEMaaSAdapter(s)}}}return Qt(e,[{key:"getBridgeConfiguration",value:function(e){var t=e.tsec2JWTEndpoint,n=e.region,r=e.dnsTld,i=e.version;return{policy:us,mrId:is,nameSpace:os,identifier:as,consumerId:ss,tsec2JWTEndpoint:t,region:n,dnsTld:r,version:i}}},{key:"getApplicationConfiguration",value:function(e){var t=e.tsec2JWTEndpoint,n=e.policy,r=e.mrId,i=e.nameSpace,o=e.consumerId,a=e.region,s=e.dnsTld,u=e.version;return{policy:n,mrId:r,nameSpace:i,identifier:"application",consumerId:o,tsec2JWTEndpoint:t,region:a,dnsTld:s,version:u}}},{key:"initilizeSEMaaSAdapter",value:function(e){return new Xa.a(e)}},{key:"logBridge",value:function(e){this.bridge.log(e)}},{key:"logApplication",value:function(e){this.application.log(e)}},{key:"ingest",value:function(e){this.application.ingest(e)}},{key:"createSpan",value:function(e){return this.application&&this.application.createSpan(e)}},{key:"createUUID",value:function(){return this.application&&this.application.createUUID()}},{key:"hasBridgeLoggingEnabled",value:function(){return!!this.bridge}},{key:"hasApplicationLoggingEnabled",value:function(){return!!this.application}},{key:"buildLog",value:function(e,t){var n=t.detail,r={message:"cells-bridge::".concat(e),properties:{}},i=Wt({},n,r);switch(e){case ls:var o=t.page,a=t.components;i.properties={page:o,components:a};break;case hs:var s=t.name,u=t.params,c=t.pattern;i.properties={route:s,params:u,pattern:c};break;case ps:var l=t.event,h=t.detail,f=h.page,p=l.detail;i.properties={page:f,params:p};break;case _s:var v=t.params,d=t.url;i.properties={params:v,url:d};break;case Es:i.properties=Wt({},t);break;case Ps:var g=t.detail,y=t.event,m=g.message,b=g.properties,_=y.detail;i.message=m,i.properties=this.unflattenData(b,_);break;case fs:case vs:case ds:case gs:case ys:case ms:case bs:case ks:case ws:case Cs:case Ts:case Ss:}return i}},{key:"isBridgeLoggableEvent",value:function(e){var t=[ls,hs,ps,_s,Es];return t.includes(e)}},{key:"unflattenData",value:function(e,t){var n={};return Object.keys(e).forEach(function(r){var i=e[r],o=null;if(i instanceof Object){var a=i.bind;o=ts(t,a)}else o=i;ns(n,r,o)}),n}}]),e}(),Ns={extend:Zt,defaultChangedCallback:Xt,BRIDGE_CHANNEL_KEY:zo},Rs=tn,As=function(){function e(t){rn(this,e),t.postMessageTargetOrigin?"*"===t.postMessageTargetOrigin?(this.enabled=!1,console.warn("For security reasons postMessageTargetOrigin can't be the wildcard '*'. See docs for more info. ")):(this.enabled=!0,this.postMessageTargetOrigin=t.postMessageTargetOrigin):this.enabled=!1,this.componentConnector=t.ComponentConnector,this.bridgeChannelManager=t.BridgeChannelManager}return an(e,[{key:"setupPostMessages",value:function(){var e=this;this.enabled&&(window.addEventListener("message",function(t){var n=t.data;if(n.event){var r=e.bridgeChannelManager.getPostMessageChannel(n.event),i=e.componentConnector.createEvent(n.event,n.detail);r.next(i)}}),this._sendPostMessage({event:"__bridge-ready"}),this.bridgeChannelManager.getBridgeChannel("send_post_message").subscribe(function(t){return e._sendPostMessage(t.detail)}))}},{key:"_sendPostMessage",value:function(e){window.parent&&window.parent.postMessage({eventName:e.event,eventDetail:e.detail},this.postMessageTargetOrigin)}}]),e}(),Is=As,xs=$i.dasherize,Ls=$i.camelize,Ms=Hi.bindingCodes,js=Hi.binding,Ds=Hi.componentsPath,Bs=Hi.composerEndpoint,Us=Hi.externalEvents,Fs=Hi.externalEventsCodes,Vs=Hi.initialTemplate,Hs=Hi.pagesPath,Gs=Hi.prplCodes,qs=Hi.prpl,zs=Hi.preRenderState,Ws=(Hi.renderEngines,js.DEFAULT),Ks=qs.DEFAULT,Ys=0,Qs={},Js=function(){function e(t){var n=this;hn(this,e),this.ComponentConnector=null,this.DomManager=null,this.ImportManager=null,this.PageManager=null,this.Router=null,this.TemplateManager=null,this.Sanitizer=null,this.BridgeChannelManager=null,this.binding=Ws,this.prplLevel=Ks,this.cache=!0,this.channel="global",this.componentsPath=Ds,this.templatesPath="",this.crossContainerId="__cross",this.debug=!0,this.preCache=!1,this.preRender=!1,this.storagePrefix="__bridge-",this.version="3.12.0",this.viewLimit=1e3,this.initialTemplate=Vs,this.__mainNodeElement=null,this.externalEvents=Us,this.pages=[],this.pagesPath=Hs,this.remoteTemplates=[],this.useComposerEngine=!1,this.appJson="",this.appId="",this.composerEndpoint=Bs,this.templatesPath="",this.monitoring=null,this.logs=!1,this.navRequestListener=null;var r=Fs.NAV_REQUEST,i=Fs.ROUTER_BACKSTEP;t&&"object"===ln(t)||(t={}),t.prplLevel=this._normalizePrplLevel(t.prplLevel),this.preRenderingPages={};var o=t.dependencies;delete t.dependencies,cn(this,t),this._initDependencies(o),"global"===this.channel&&(this.ComponentConnector.manager.channels=Qs),this.useComposerEngine&&this._initComposerEngine(),this.mainNode?this._plugExternalEvents():console.warn("You should indicate the main node of your app"),t.featureFlag&&(t.featureFlag.subscribe&&this.featureFlagCollection.subscribe(t.featureFlag.subscribe),t.featureFlag.defaultChangedCallback&&Ns.defaultChangedCallback(t.featureFlag.defaultChangedCallback),t.featureFlag.defaultFeatures&&this.featureFlagCollection.update({features:t.featureFlag.defaultFeatures}),t.featureFlag.src&&fetch(t.featureFlag.src).then(function(e){return e.json()}).then(function(e){return n.featureFlagCollection.update(e)})),this.id=Ys++,this._initCrossComponents(),this.cache&&(this.PageManager.persistent=!0),this.generateRequestUrl&&(console.assert("function"==typeof this.generateRequestUrl,"generateRequestUrl has to be a function"),this.PageManager.generateRequestUrl=this.generateRequestUrl),this.onPageDefinitionNotFound&&(console.assert("function"==typeof this.onPageDefinitionNotFound,"onPageDefinitionNotFound has to be a function"),this.PageManager.onPageDefinitionNotFound=this.onPageDefinitionNotFound),window.$core=window.$core||[],this.debug?(window.$core.push(this),this.printDebugInfo()):window.$core.push({log:function(e){return n.log(e)},ingest:function(e){return n.ingest(e)},createSpan:function(e){return n.createSpan(e)},createUUID:function(){return n.createUUID()},logout:function(){return n.logout()},subscribeToEvent:function(e,t){return n.subscribeToEvent(e,t)},registerInConnection:function(e,t,r){return n.registerInConnection(e,t,r)},unsubscribe:function(e,t){return n.unsubscribe(e,t)},registerOutConnection:function(e,t,r){return n.registerOutConnection(e,t,r)},publish:function(e,t,r){return n.publish(e,t,r)},navigate:function(e,t){return n.navigate(e,t)},trackEvent:function(e){return n.trackEvent(e)},navigateToNative:function(e,t){return n.navigateToNative(e,t)},backStep:function(){return n.backStep()}}),window.cells=window.$core[0],this.BridgeChannelManager.initAppContextChannel(),this.BridgeChannelManager.getCancelledBackNavigationChannel(),this.ActionChannelManager.subscribeAll(),this._executePendingBridgeQueue(),this.logs&&this._logBridgeReady(),this.Router.handler=function(){return n.routeHandler()},this.Router.addRoutes(this.routes),this._initSkipNavigations(),this.Router.start(),this.navRequestListener=function(e){n.Router.hashIsDirty&&(window.location.hash="#!");var r=e.event,i=e.detail,o=i.page,a=i.params,s=i.skipHistory,u=i.cleanUntil,c=i.replace||!1,l={};if(!o&&i.paramPage&&r.detail&&(o=r.detail[i.paramPage]),r.detail&&a)for(var h in a)a.hasOwnProperty(h)&&(l[a[h]]=r.detail[h]);u&&n.Router.clearStackUntil(u),n.Router.go(o,l,c,s),cn(n,t)},Ti.on(r,this.navRequestListener),Ti.on(i,function(e){return n.handleBack(e)}),this.PostMessageManager.setupPostMessages()}return pn(e,[{key:"goBack",value:function(){return this.Router.back()}},{key:"handleBack",value:function(){this.goBack()}},{key:"_executePendingBridgeQueue",value:function(){if(window.cellsBridgeQueue&&window.cellsBridgeQueue.length){for(var e=0;e<window.cellsBridgeQueue.length;e++){var t=window.cellsBridgeQueue[e],n=t.command,r=t.parameters,i=this[n];if(!i)return void console.log("WARNING: Invalid cells bridge command execution: ".concat(n," (QUEUE)."));console.log("Executing queued command ".concat(n,".")),i.apply(this,r)}delete window.cellsBridgeQueue}}},{key:"_logBridgeReady",value:function(){var e=this.appId,t=this.version,n=this.binding,r=this.prplLevel,i=this.cache,o=this.preCache,a=this.preRender,s="cells-bridge::ready",u={appId:e,version:t,binding:n,href:window.location.href,prplLevel:r,cache:i,preCache:o,preRender:a},c={message:s,properties:u};this.logBridge(c)}},{key:"_initSkipNavigations",value:function(){if(this.skipNavigations&&this.skipNavigations.length>0){for(var e=0;e<this.skipNavigations.length;e++)this.skipNavigations[e].skipHistory=!0;this.Router.addSkipNavigations(this.skipNavigations)}}},{key:"_normalizePrplLevel",value:function(e){var t,n=qs.VALUES;return t=n.indexOf(e)>-1?e:n[e]||Ks}},{key:"_dispatchEvent",value:function(e,t){var n=this.getMainNode(),r=t?new CustomEvent(e,{detail:t}):new CustomEvent(e);n.dispatchEvent(r)}},{key:"_plugExternalEvents",value:function(){var e=this,t=this.externalEvents.length,n=this.getMainNode();if(n){for(var r=function(t){var n=e.externalEvents[t];Ti.on(n,function(t){e._dispatchEvent(n,t),e.logs&&e.monitor(n,t)})},i=0;i<t;i++)r(i);this._initEventChannels()}else console.warn("The defined main node does not exist")}},{key:"trackEvent",value:function(e){var t=Fs.TRACK_EVENT;Ti.emit(t,{detail:e})}},{key:"monitor",value:function(e,t){var n=Fs.LOG_EVENT,r=e===n,i=r||this.isBridgeLoggableEvent(e);if(i){var o=this.monitoring.buildLog(e,t),a=r?"log":"logBridge";this[a](o)}}},{key:"isBridgeLoggableEvent",value:function(e){return this.monitoring.isBridgeLoggableEvent(e)}},{key:"log",value:function(e){this.hasApplicationLoggingEnabled()&&this.monitoring.logApplication(e)}},{key:"logBridge",value:function(e){this.hasBridgeLoggingEnabled()&&this.monitoring.logBridge(e)}},{key:"ingest",value:function(e){this.hasApplicationLoggingEnabled()&&this.monitoring.ingest(e)}},{key:"createSpan",value:function(e){return this.hasApplicationLoggingEnabled()?this.monitoring.createSpan(e):{start:function(){},finish:function(){}}}},{key:"createUUID",value:function(){return this.monitoring.createUUID()}},{key:"hasBridgeLoggingEnabled",value:function(){return this.monitoring.hasBridgeLoggingEnabled()}},{key:"hasApplicationLoggingEnabled",value:function(){return this.monitoring.hasApplicationLoggingEnabled()}},{key:"_initEventChannels",value:function(){var e=this.getMainNode();this.BridgeChannelManager.initEventChannels(e,this.externalEvents),this._addInitialSubscribersToEvents()}},{key:"_addInitialSubscribersToEvents",value:function(){this.eventSubscriptions&&this.eventSubscriptions.length>0&&this._subscribeToEvents(this.eventSubscriptions)}},{key:"_subscribeToEvents",value:function(e){var t=this;e.forEach(function(e){var n=e.event,r=e.callback;t.subscribeToEvent(n,r)})}},{key:"_initCrossComponents",value:function(){var e=this.TemplateManager.parseTemplateId(this.crossContainerId),t=this.TemplateManager.get(e),n=document.getElementById(e);t||(n?this.TemplateManager.register(this.crossContainerId,n):(t=this.TemplateManager.create(this.crossContainerId,{tagName:"div"}),document.body.appendChild(t.node)))}},{key:"_initDependencies",value:function(e){e=cn({ComponentConnector:Xo,DomManager:zi,ImportManager:Sa,TemplateManager:xa,PageManager:ro,Router:ka,Sanitizer:eo,BridgeChannelManager:za,ActionChannelManager:Ya,monitoring:Os,featureFlagCollection:Yo,PostMessageManager:Is},e);for(var t in e)e.hasOwnProperty(t)&&(this[t]=new e[t](this))}},{key:"_initComposerEngine",value:function(){this.composerEngine=new Ja(this.ComponentConnector.manager,composerEngine),this.composerEngine.init(),this.PageManager.composerEngine=this.composerEngine}},{key:"_createCellsComponent",value:function(e,t){var n=new Oa(e,t);return e.featureFlag&&Ns.extend(n,this),n}},{key:"createCCComponent",value:function(e){var t=this.TemplateManager.get(this.crossContainerId),n=t.node.querySelector(e.tagName);if(!n){var r=this._createCellsComponent(e,this);return r.__parentTemplate=t,this.ComponentConnector.register(r.node,r.spec.connections),r}this.ComponentConnector.progressiveRegister(n,e.connections)}},{key:"createUIComponent",value:function(e){var t=Ms.ALWAYS,n=Ms.DELAYED,r=Ms.UI,i=this.binding,o=this._createCellsComponent(e,this);return i!==t&&i!==n&&i!==r||this.ComponentConnector.register(o.node,o.connections),o}},{key:"createDMComponent",value:function(e){var t=Ms.ALWAYS,n=Ms.DELAYED,r=this.binding,i=this._createCellsComponent(e,this);return r!==t&&r!==n||this.ComponentConnector.register(i.node,i.connections),i}},{key:"_createLocalComponent",value:function(e,t,n){for(var r=[],i=0,o=t.length;i<o;i++){var a=t[i],s=this["create"+e+"Component"](a);s&&(s.__parentTemplate=s.__parentTemplate||n,r.push(s))}return r}},{key:"createComponentsByType",value:function(e,t){for(var n=[],r=["CC","UI","DM"],i=0,o=r.length;i<o;i++){var a=r[i],s=e[a];n=n.concat(this._createLocalComponent(a,s,t))}return n}},{key:"_createComponents",value:function(e,t){for(var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=Fs.PAGE_READY,o=e.page,a=this,s=this.Sanitizer.split(e.components),u=this.createComponentsByType(s,t),c=[],l=[],h=0,f=u.length;h<f;h++){u[h].setProps();var p=u[h],v=p.__parentTemplate.name;l[v]||(l[v]=this.TemplateManager.get(v)),l[v].append(p),p.isUnresolved()&&c.push(p)}switch(Ti.emit(i,{page:o,components:e.components.map(function(e){return e.tagName}).join(", ")}),this.prplLevel){case Gs.NONE:case Gs.DEFER:this.ImportManager.loadComponent(c,a.componentsPath).then(function(){n.selectTemplate(o,r)});break;case Gs.PROGRESSIVE:this.ImportManager.loadComponent(c,a.componentsPath);break;case Gs.HERO:this.selectTemplate(o,r),this.ImportManager.loadComponentByPriority(c,a.componentsPath)}}},{key:"createPageFromWebComponent",value:function(e){var t="".concat(e,"-page"),n=this.TemplateManager.getNode(e);return this.BridgeChannelManager.getPrivate(e),!n&&(n=this.TemplateManager.createFromComponent(e,t),n.isUnresolved()&&void 0===n.node.updateComplete)?this.loadPolymerWebComponent(e):Promise.resolve()}},{key:"_isLocalTemplate",value:function(e){var t=!0;return this.composerEndpoint&&this.remoteTemplates&&(t=this.remoteTemplates.indexOf(e)===-1),t}},{key:"createTemplate",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e,i=e.page,o=this.TemplateManager.getNode(i),a=this.composerEngine&&!this.PageManager._isLocalComposer(i);return this.BridgeChannelManager.getPrivate(i),!n&&this.preRenderingPages[i]?void(this.preRenderingPages[i]=zs.REQUESTED):(o&&!a?this.selectTemplate(i,n):r&&r.template&&(this.prplLevel===Gs.DEFER&&this._isLocalTemplate(i)?this.onlyLitElements?this._createTemplateFromSpec(i,r,n):this.ImportManager.loadBundleForTemplate(this.componentsPath,i).then(function(){t._createTemplateFromSpec(i,r,n)}):this._createTemplateFromSpec(i,r,n)),void this._preRender(e,n))}},{key:"_preRender",value:function(e,t){var n=this;if((this.preCache===!0||this.preRender===!0)&&e.pages)for(var r in e.pages)if(e.pages.hasOwnProperty(r)){var i=r===name||this.TemplateManager.cache[r];if(i)continue;this.preRender&&t===!1&&(this.preRenderingPages[r]=zs.WORKING),this.loadTemplate(r).then(function(e){if(n.preRender&&t===!1){var r=!0;e.page?n._idleCallback(function(){return n.createTemplate(e,r)}):console.warn("Missing page. ",e)}})}}},{key:"_createTemplateFromSpec",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.TemplateManager.create(e,t.template,r);if(this.prplLevel===Gs.PROGRESSIVE&&this.selectTemplate(e,r),this.ComponentConnector.register(i.node,i.connections),t.pages&&this.Router.addRoutes(t.pages),i.isUnresolved())switch(this.prplLevel){case Gs.NONE:case Gs.DEFER:this.ImportManager.loadComponent(i,this.componentsPath).then(function(){n._createComponents(t,i,r)});break;case Gs.PROGRESSIVE:case Gs.HERO:this._createComponents(t,i,r)}else this._createComponents(t,i,r)}},{key:"parseTemplateId",value:function(e){return"cells-template-"+e.replace(/\./g,"-")}},{key:"parse",value:function(e,t){return e=Ls("parse-"+e),"function"==typeof this[e]?this[e](t):t}},{key:"printDebugInfo",value:function(){var e=function(e,t){var n=e?t:"#b0bec5";return"background:".concat(n,"; color:#fff; padding:2px 4px; margin-right: 5px;")};console.log("%cbridge version: ".concat(this.version," %cbinding: ").concat(this.binding," %cprplLevel: ").concat(this.prplLevel," %ccache: ").concat(this.cache," %cpreCache: ").concat(this.preCache," %cpreRender: ").concat(this.preRender," %clogs: ").concat(this.logs),e(this.version,"#003f8d"),e(this.binding,"#0065ba"),e(this.prplLevel,"#008ff2"),e(this.cache,"#0093e2"),e(this.preCache,"#00aeeb"),e(this.preRender,"#41cef8"),e(this.logs,"#0025ad")),this.id>0&&console.log("%cWARNING: There are ".concat(this.id+1," simultaneous instances of the Bridge running."),e(this.id,"#FF0000"))}},{key:"routeHandler",value:function(){var e=Fs.PARSE_ROUTE,t=this.Router.currentRoute;Ti.emit(e,t),this._handleRouteLoading(t);for(var n in t.params)if(t.params.hasOwnProperty(n)){var r={detail:{value:t.params[n]},type:xs(n)+"-changed"};this.ComponentConnector.manager.get(n).next(r)}}},{key:"isRoutableComponent",value:function(e){return this.pages.indexOf(e.name)>=0}},{key:"loadTemplate",value:function(e,t){var n=this.cache,r=this.method,i=this.body,o=this.headers,a=this.app,s=this.templatesPath,u={cache:n,params:t,method:r,body:i,headers:o},c={app:a,templates:s};return this.PageManager.get(e,u,c)}},{key:"loadPolymerWebComponent",value:function(e){var t=Array(2).fill("".concat(e,"-page")).join("/"),n={spec:{path:"".concat(t,".html")}};return this.ImportManager.loadComponent(n,this.pagesPath)}},{key:"_handleRouteLoading",value:function(e){var t=this;this.isRoutableComponent(e)?this.createPageFromWebComponent(e.name).then(function(){return t.selectPage(e.name,e.params)}):this.loadTemplate(e.name,e.params).then(function(e){return t.createTemplate(e)})}},{key:"registerCurrentTemplate",value:function(e,t){var n=Fs.TEMPLATE_REGISTERED,r=Ms.UI,i=this;t&&t!==e&&this.unregisterChildren(t,i.binding===r?"DM":null),this.registerChildren(e,i.binding===r?"DM":null),this._updateChannels(t,e),Ti.emit(n,{template:e.name})}},{key:"_updateChannels",value:function(e,t){if(this.BridgeChannelManager){var n=e?e.name:void 0;this.BridgeChannelManager.updateAppContext(n,t.name),this.BridgeChannelManager.initPrivateChannel(n,t.name)}}},{key:"registerChildren",value:function(e,t){for(var n=0;n<e.children.length;n++){var r=e.children[n];(t&&t===r.type||!t)&&this.ComponentConnector.register(r.node,r.connections)}}},{key:"unregisterChildren",value:function(e,t){for(var n=0;n<e.children.length;n++){var r=e.children[n];(t&&t===r.type||!t)&&this.ComponentConnector.unregister(r.node)}}},{key:"registerInConnection",value:function(e,t,n){this.ComponentConnector.addSubscription(e,t,n)}},{key:"registerOutConnection",value:function(e,t,n){this.ComponentConnector.addPublication(e,t,n)}},{key:"unsubscribe",value:function(e,t){this.ComponentConnector.unsubscribe(e,t)}},{key:"publish",value:function(e,t,n){this.ComponentConnector.publish(e,t)}},{key:"navigate",value:function(e,t){this.Router.go(e,t)}},{key:"navigateToNative",value:function(e,t){}},{key:"backStep",value:function(){}},{key:"_waitRenderComplete",value:function(e){return e.node.updateComplete||Promise.resolve()}},{key:"selectPage",value:function(e,t){var n=this,r=Fs.TEMPLATE_REGISTERED,i=this.TemplateManager.get(e),o=this.TemplateManager.get(this.TemplateManager.selected),a=o?o.name:null;this.onRender&&this.onRender(i.node),un(regeneratorRuntime.mark(function o(){return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,n._waitRenderComplete(i);case 2:n._handleParams(i.node,t),n.TemplateManager.select(e,n.BridgeChannelManager,n.binding),n.BridgeChannelManager&&(n.BridgeChannelManager.updateAppContext(a,e),n.BridgeChannelManager.initPrivateChannel(a,e)),Ti.emit(r,{template:e});case 6:case"end":return o.stop()}},o)}))()}},{key:"_handleParams",value:function(e,t){var n=e.params&&Object.keys(t).length>0;n&&(e.params=t)}},{key:"selectTemplate",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=Fs.TEMPLATE_TRANSITION_END,i=Ms.CURRENTVIEW,o=Ms.UI,a=Ms.DELAYED,s=this,u=this.TemplateManager.get(e),c=n!==!0||this.preRenderingPages[e]===zs.REQUESTED;if((s.binding===i||s.binding===o)&&c){var l=this.TemplateManager.get(this.TemplateManager.selected),h=function(){return t.registerCurrentTemplate(u,l)};u.node.animationCompleteEvent?Ti.listenToOnce(u.node,u.node.animationCompleteEvent,h):Ti.once(r,h)}if(s.onRender&&(u.fixedChildren.length>0?s.onRender(u.node,u.fixedChildren):s.onRender(u.node)),n&&delete this.preRenderingPages[e],c){var f=function(){return t.TemplateManager.select(e,t.BridgeChannelManager,s.binding)};s.binding===a?this._idleCallback(f):f()}}},{key:"_idleCallback",value:function(e){this.BridgeChannelManager.getIdleCallbackChannel().subscribe(e)}},{key:"subscribeToEvent",value:function(e,t){if(this.externalEvents.indexOf(e)<0)return void console.warn("Trying to subscribe to a non existing event: ",e);if("function"!=typeof t)return void console.warn("You must provide a function callback to subscribe to the event: ",e);var n=this.getMainNode();this.BridgeChannelManager.subscribeToEvent(n,e,t)}},{key:"getMainNode",value:function(){return this.__mainNodeElement||(this.__mainNodeElement=document.querySelector("#"+this.mainNode)),this.__mainNodeElement}},{key:"_resetBridgeChannels",value:function(){var e=!0;this.BridgeChannelManager.resetBridgeChannels(this.getMainNode(),e)}},{key:"logout",value:function(){this.TemplateManager.selected!==this.initialTemplate&&(this.BridgeChannelManager.publishPrivatePageStatus(this.TemplateManager.selected,!1),this._resetBridgeChannels(),this.TemplateManager.removeTemplateChildrens(this.crossContainerId),this.TemplateManager.removeTemplates(void 0,this.crossContainerId),this._initEventChannels(),this.composerEngine&&this.composerEngine.reset(),this.Router.init(),this.Router.go(this.initialTemplate))}}]),e}(),$s=Js,Xs=function(e){return e.toLowerCase().replace(/-(.)/g,function(e,t){return t.toUpperCase()})},Zs=function(e){var t,n="-changed";return e.indexOf(n,e.length-n.length)!==-1&&(t=e.slice(0,-n.length),t=Xs(t)),t},eu=function(e,t,n,r){var i,o,a=Zs(e.type);return a&&e.detail&&e.detail.hasOwnProperty("value")?(o=e.detail.value,t=t||a,i=e.detail.path?e.detail.path.replace(a,t):t):(i=t,o=e.detail),void 0!==n&&void 0===n.is&&"object"===Cn(o)&&(Polymer&&void 0===Polymer.Element&&!r?o=JSON.stringify(o):(Polymer&&Polymer.Element&&n instanceof Polymer.Element)!==!1||r||(o=JSON.stringify(o))),{path:i,value:o,property:t}},tu=function(e){function t(){return vn(this,t),yn(this,En(t).apply(this,arguments))}return kn(t,e),gn(t,[{key:"wrapCallback",value:function(e,t){return function(n){var r=function(e){setTimeout(function(){"requestIdleCallback"in window?window.requestIdleCallback(e):setTimeout(e,1)},100)},i=function(o,a){var s=this._isPolymerElement(e),u=this._isLitElement(e);s||u?("function"==typeof t?this._dispatchActionFunction(n,e,t):"function"==typeof e[t]?this._dispatchActionFunction(n,e,t):this._dispatchActionProperty(n,e,t,u),a&&a.disconnect()):r(i)}.bind(this);if(this._isPolymerElement(e)||this._isLitElement(e))i();else{var o=new MutationObserver(i),a={attributes:!1,childList:!0,characterData:!0};o.observe(e,a),r(i,100)}}.bind(this)}},{key:"_whichPolymerVersion",value:function(e){var t=-1;return Polymer&&void 0!==Polymer.Element&&(e instanceof Polymer.Element||e instanceof Polymer.LegacyElementMixin)?t=2:void 0!==e.__isPolymerInstance__&&(t=1),t}},{key:"_isPolymerElement",value:function(e){return this._whichPolymerVersion(e)>0}},{key:"_isLitElement",value:function(e){var t=e.tagName,n=t.toLowerCase(),r=window,i=r.customElements;return i&&!!i.get(n)}},{key:"_isEventAtTarget",value:function(e){var n;if(Polymer&&Polymer.Settings&&(Polymer.Settings.hasShadow===!1||Polymer.Settings.useShadow===!1)){var r=Polymer.dom(e);n=r.localTarget===e.currentTarget}else n=bn(En(t.prototype),"_isEventAtTarget",this).call(this,e);return n}},{key:"_dispatchActionFunction",value:function(e,t,n){var r,i=Zs(e.type);r=i&&e.detail&&e.detail.hasOwnProperty("value")?Polymer&&Polymer.dom(e).rootTarget?Polymer.dom(e).rootTarget[i]:e.detail.value:e.detail,this.bridge&&this.bridge.debug&&this.bridge.parsePayload&&(""+t[n]).indexOf(".data")>-1&&(r=this.bridge.parsePayload(e.detail),console.warn("%c"+t.tagName+"%c is using an incompatible payload data in "+n,"background: #ff9800; color: white; padding: 4px 4px 4px 10px","background: #ff9800; color: rgba(255,255,255,0.9); padding: 4px 10px 4px 0")),"function"==typeof n?n(r):t[n](r)}},{key:"_getTargetProperties",value:function(e){var t;return e.constructor.config?t=e.constructor.config.properties:e.constructor._properties&&(t=e.constructor._properties),t}},{key:"_dispatchActionProperty",value:function(e,t,n,r){var i,o=eu(e,n,t,r);if(t.updateComplete instanceof Promise&&"function"==typeof t.render)return t[o.property]=o.value;if(t&&t.constructor._finalize){var a=t.constructor.properties[o.property];return a?void(t[o.property]=o.value):this._handleAttribute(t,o)}return(t&&t.getPropertyInfo||void 0!==Polymer.Element&&t instanceof Polymer.Element==!1)&&(i=t.getPropertyInfo?t.getPropertyInfo(o.property):this._getTargetProperties(t)[o.property],i&&i.defined&&!i.readOnly&&!i.computed)?t.set(o.path,o.value):(t&&void 0===t.getPropertyInfo||void 0!==Polymer.Element&&t instanceof Polymer.Element==!1)&&(i=void 0!==this._getTargetProperties(t)?this._getTargetProperties(t)[o.property]:void 0,i&&!i.readOnly&&!i.computed)?t.set(o.path,o.value):this._handleAttribute(t,o)}},{key:"_handleAttribute",value:function(e,t){var n=t.value,r=t.path;return"boolean"!=typeof n||n?e.setAttribute(r,n):e.removeAttribute(r)}},{key:"register",value:function(e,n){if(bn(En(t.prototype),"register",this).call(this,e,n),e&&n&&!e.__isCellsConnected){if(n.in)for(var r in n.in)n.in.hasOwnProperty(r)&&this.manager.get(r)._events[0]&&(n.ignoreAttr?n.ignoreAttr.push(n.in[r].bind):n.ignoreAttr=[n.in[r].bind]);if(n.out)for(var i in n.out)if(n.out.hasOwnProperty(i)){var o=Zs(n.out[i].bind),a=this._whichPolymerVersion(e);if(2===a){if(o&&e.__data&&!this.manager.get(i)._events[0]&&e&&e._hasReadOnlyEffect&&!e._hasReadOnlyEffect(o)&&!e._hasComputedEffect(o)){var s=e[o];e.__data[o]=void 0,e[o]=s}}else if(o&&e.__data__&&!this.manager.get(i)._events[0]&&e&&e.getPropertyInfo){var u=e.getPropertyInfo(o);if(u.defined&&!u.readOnly&&!u.computed){var c=e[o];e.__data__[o]=void 0,e[o]=c}}}e.__isCellsConnected=!0}}}]),t}(Xo),nu=function(e){function t(){return Pn(this,t),Rn(this,In(t).apply(this,arguments))}return xn(t,e),Nn(t,[{key:"isUnresolved",value:function(){return Tn(this.node)}}]),t}(Na),ru=function(e){function t(){return jn(this,t),Un(this,Vn(t).apply(this,arguments))}return Hn(t,e),Bn(t,[{key:"_createCellsTemplate",value:function(e,t){var n=new nu(t),r=this._createCellsTemplateConfig(e);return n.config(r),n}},{key:"_createCellsTemplateConfig",value:function(e){return{name:e,template:{id:this.parseTemplateId(e),name:this.parseTemplateName(e)}}}}]),t}(xa),iu=function(e){function t(){return zn(this,t),Yn(this,Jn(t).apply(this,arguments))}return $n(t,e),Kn(t,[{key:"isUnresolved",value:function(){return Tn(this.node)}}]),t}(Oa),ou=function(e){function t(e){var n;if(tr(this,t),n=ir(this,ur(t).call(this,e)),Polymer&&e.avoidPolymerEventCache===!0){var r=Polymer.Base._getEvent;Polymer.Base._getEvent=function(e,t,n){return r(e,t,n,!1)}}return n}return cr(t,e),rr(t,[{key:"_initDependencies",value:function(e){e=er({ComponentConnector:tu,TemplateManager:ru},e),ar(ur(t.prototype),"_initDependencies",this).call(this,e)}},{key:"_createCellsComponent",value:function(e,t){var n=new iu(e,t);return e.featureFlag&&Ns.extend(n,this),n}}]),t}($s),au={SYNC_CHANNELS_DATA:"channels",RESET_CHANNELS_DATA:"reset-channels",NATIVE:{BACK_STEP:"back",NAVIGATION:"nav",RESET_WEBVIEW:"reset-webview",LOGOUT:"logout",UPDATE_SKIP_NAVIGATIONS:"skip-nav"},HTML:{BACK_STEP:"pop",NAVIGATION:"push",NAVIGATION_AND_REPLACE:"popAndPush",BRIDGE_READY:"bridgeReady",PAGE_LOADED:"pageLoaded",PAGE_UNLOADED:"pageUnloaded"}},su={NATIVE_CHANNEL_SYNC:"native-channel-sync",NATIVE_BACKSTEP_REQUEST:"native-backstep-request",NATIVE_NAVIGATION_REQUEST:"native-nav-request",INTERNAL_ROUTER_NAVIGATION:"nav-request",INTERNAL_ROUTER_BACKSTEP:"backstep",INTERNAL_ROUTER_BACKSTEP_FROM_NATIVE:"backstep-from-native",ROUTER_BACKSTEP:"backstep-request",ROUTER_NAVIGATION:"external-nav-request",RESET_WEBVIEW:"reset-webview",NATIVE_LOGOUT:"native-logout",UPDATE_SKIP_NAVIGATIONS:"update-skip-navigations",SYNC_CHANNELS_DATA:"sync-channels-data",PRIVATE:{SYNC_CHANNELS_DATA:"__cells-data-sync",ROUTER_NAVIGATION:"__cells-nav-request"}},uu={NATIVE_CHANNEL:"NativeBridge",NATIVE_PLUGIN_CHANNEL:"PluginBridge"},cu={NATIVE_ROUTE:"cells-native-route:",PRIVATE_CHANNEL:"__bridge_"},lu={SUCCESS:0,ERROR:1},hu={SUCCESS_ACCESSOR:"success",FAIL_ACCESSOR:"fail"},fu=su.PRIVATE,pu=function(e){function t(){return fr(this,t),dr(this,yr(t).apply(this,arguments))}return mr(t,e),vr(t,[{key:"handleI18n",value:function(e){this.manager.get("".concat(this.getNativeEventChannelPrefix(),"locales")).subscribe(e)}},{key:"handleConfig",value:function(e){this.manager.get("".concat(this.getNativeEventChannelPrefix(),"config")).subscribe(e)}},{key:"handleAppLoad",value:function(e){this.manager.get("".concat(this.getNativeEventChannelPrefix(),"app_loaded")).subscribe(e)}},{key:"handleAppContextChange",value:function(e){this.manager.get(this.getAppContextChannelName()).subscribe(e)}},{key:"getNativeEventChannelPrefix",value:function(){return"__native_bridge_evt_"}},{key:"getAppContextChannelName",value:function(){return"__bridge_app"}},{key:"getChannels",value:function(){var e=this._getPublicChannels(this.manager.channels);return e.filter(this._isValidChannel.bind(this))}},{key:"getChannel",value:function(e){return this._getChannel(e,this.manager.channels)}},{key:"getAllChannels",value:function(){var e=this._getChannels(this.manager.channels);return e.filter(this._isValidChannel.bind(this))}},{key:"_getChannels",value:function(e){var t=this,n=Object.keys(e);return n.map(function(n){return t._getChannel(n,e)})}},{key:"_getPublicChannels",value:function(e){var t=this,n=Object.keys(e),r=n.filter(this._isPublicChannel);return r.map(function(n){return t._getChannel(n,e)})}},{key:"_isPublicChannel",value:function(e){return!e.startsWith(cu.PRIVATE_CHANNEL)}},{key:"_getChannel",value:function(e,t){var n=t[e];return{name:e,payload:this._getChannelPayload(n)}}},{key:"_getChannelPayload",value:function(e){return e._events[0]&&e._events[0].detail}},{key:"_isValidChannel",value:function(e){return this._hasPayload(e)&&!this._hasForbiddenPayload(e)&&this._hasContent(e)&&!this._isHTMLElement(e);
}},{key:"_hasPayload",value:function(e){return e.payload}},{key:"_hasContent",value:function(e){return!e.payload.constructor===Object||Object.keys(e.payload).length>0}},{key:"_hasForbiddenPayload",value:function(e){var t=["sourceEvent","preventer"],n=Object.keys(e.payload);return Array.prototype.includes.apply(n,t)}},{key:"_isHTMLElement",value:function(e){return e.payload.node||e.payload instanceof HTMLElement}},{key:"syncChannels",value:function(e){e.forEach(this._syncChannel.bind(this))}},{key:"syncAllChannels",value:function(){this.getAllChannels().forEach(this._syncChannel.bind(this))}},{key:"_syncChannel",value:function(e){var t=e.name,n=e.payload,r=this.manager.get(t);r.next(new CustomEvent(fu.SYNC_CHANNELS_DATA,{detail:n}))}},{key:"wrapEventHandler",value:function(e,t,n){t&&(t.nativeLink&&Ti.emit(su.NATIVE_NAVIGATION_REQUEST,{event:e,detail:t.nativeLink}),t.hasOwnProperty("forward-to-native")&&Ti.emit(su.NATIVE_CHANNEL_SYNC,{event:e,detail:n.name}))}}]),t}(tu),vu=pu,du=function(){function e(){_r(this,e)}return kr(e,[{key:"execute",value:function(e,t){var n=au.SYNC_CHANNELS_DATA,r=au.NATIVE,i=r.BACK_STEP,o=r.NAVIGATION,a=r.RESET_WEBVIEW,s=r.LOGOUT,u=r.UPDATE_SKIP_NAVIGATIONS;e&&(e===n?this._executeSyncChannelsData(t):e===i?this._executeBackStep(t):e===o?this._executeNavigation(t):e===a?this._executeResetWebview():e===s?this._executeLogout():e===u?this._executeUpdateSkipNavigations(t):console.log("Unkown operation received from native message: ".concat(JSON.stringify({operation:e,payload:t}))))}},{key:"_executeSyncChannelsData",value:function(e){var t=this._getChannelsFromPayload(e);Ti.emit(su.SYNC_CHANNELS_DATA,{channels:t})}},{key:"_getChannelsFromPayload",value:function(e){var t=e.channels;return Array.isArray(t)||(t=[t]),t.map(this._mapChannel)}},{key:"_mapChannel",value:function(e){var t=e.channelName,n=e.channelPayload;return{name:t,payload:n}}},{key:"_executeBackStep",value:function(e){Ti.emit(su.ROUTER_BACKSTEP,e)}},{key:"_executeNavigation",value:function(e){Ti.emit(su.ROUTER_NAVIGATION,e)}},{key:"_executeResetWebview",value:function(){Ti.emit(su.RESET_WEBVIEW)}},{key:"_executeLogout",value:function(){Ti.emit(su.NATIVE_LOGOUT)}},{key:"_executeUpdateSkipNavigations",value:function(e){Ti.emit(su.UPDATE_SKIP_NAVIGATIONS,e)}}]),e}(),gu=du,yu=function(){function e(){wr(this,e),this._callbacks={},console.log("CellsPluginManager()"),this.init()}return Tr(e,[{key:"source",get:function(){return window[uu.NATIVE_PLUGIN_CHANNEL]}}]),Tr(e,[{key:"init",value:function(){this._prepareCellsNativeBridgeNameSpace()}},{key:"_prepareCellsNativeBridgeNameSpace",value:function(){window.CellsNativePlugins=window.CellsNativePlugins||{},window.CellsNativePlugins.pluginManager={execute:this._executePlugin.bind(this),pluginResponse:this._processPluginResponse.bind(this)}}},{key:"_executePlugin",value:function(e,t,n,r,i){var o=this._createUUID(),a=this._createPluginMessage(o,n,r,i);this._storeCallback(o,e,t),this._sendMessage(a)}},{key:"_processPluginResponse",value:function(e,t){var n=lu.SUCCESS,r=hu.SUCCESS_ACCESSOR,i=hu.FAIL_ACCESSOR,o=this._normalizePluginResponse(t),a=o.status,s=o.payload,u=a==n?r:i,c=this._callbacks[e][u];c(s),delete this._callbacks[e]}},{key:"_normalizePluginResponse",value:function(e){return"string"==typeof e?JSON.parse(e):e}},{key:"_createUUID",value:function(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)})}},{key:"_createPluginMessage",value:function(e,t,n,r){return{id:e,pluginId:t,actionId:n,payload:r}}},{key:"_storeCallback",value:function(e,t,n){this._callbacks[e]={success:t,fail:n}}},{key:"_sendMessage",value:function(e){this.source.postMessage(JSON.stringify(e))}}]),e}(),mu=yu,bu=function(){function e(){Sr(this,e),this.operationManager=null,this.pluginManager=null,console.log("CellsNativeManager()"),this.init()}return Or(e,[{key:"source",get:function(){return window[uu.NATIVE_CHANNEL]}}]),Or(e,[{key:"init",value:function(){console.log("CellsNativeBridge::init(".concat(name,")")),this.operationManager=new gu,this.pluginManager=new mu,this._attachEventListeners()}},{key:"_attachEventListeners",value:function(){window.addEventListener("message",this._processMessage.bind(this))}},{key:"sendNavigationMessage",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];console.log("CellsNativeManager::sendNavigationMessage(".concat(e,", ").concat(t,", ").concat(n,")"));var r=this._createNavigationMessage(e,t,n);this._sendMessage(r)}},{key:"sendBackstepMessage",value:function(){console.log("CellsNativeManager::sendBackstepMessage()");var e=this._createBackStepMessage();this._sendMessage(e)}},{key:"sendSyncChannelsDataMessage",value:function(e){console.log("CellsNativeManager::sendSyncChannelsDataMessage with data = ",e);var t=e.map(this._mapChannel),n=this._createSyncChannelsDataMessage(t);this._sendMessage(n)}},{key:"sendBridgeReadyMessage",value:function(){var e=this._createBridgeReadyMessage();this._sendMessage(e)}},{key:"sendPageStatusMessage",value:function(e,t){var n=this._createPageStatusMessage(e,t);this._sendMessage(n)}},{key:"_mapChannel",value:function(e){var t=e.name,n=e.payload;return{channelName:t,channelPayload:n}}},{key:"resetChannels",value:function(){console.log("CellsNativeManager::resetChannels()");var e=this._createResetChannelsMessage();this._sendMessage(e)}},{key:"_createBackStepMessage",value:function(){var e=au.HTML.BACK_STEP;return{op:e,payload:{}}}},{key:"_createPageStatusMessage",value:function(e,t){return{op:t?au.HTML.PAGE_LOADED:au.HTML.PAGE_UNLOADED,payload:{page:e}}}},{key:"_createNavigationMessage",value:function(e,t,n){var r=au.HTML,i=r.NAVIGATION,o=r.NAVIGATION_AND_REPLACE;return{op:n?o:i,payload:{page:e,params:t}}}},{key:"_createSyncChannelsDataMessage",value:function(e){var t=au.SYNC_CHANNELS_DATA;return{op:t,payloadChannel:e}}},{key:"_createBridgeReadyMessage",value:function(){var e=au.HTML.BRIDGE_READY;return{op:e,payload:{}}}},{key:"_createResetChannelsMessage",value:function(){var e=au.RESET_CHANNELS_DATA;return{op:e,payload:{}}}},{key:"_sendMessage",value:function(e){this.source&&this.source.postMessage(JSON.stringify(e))}},{key:"_processMessage",value:function(e){var t=this._parseMessage(e.data),n=this._mapMessage(t),r=n.operation,i=n.payload;this.operationManager.execute(r,i)}},{key:"_parseMessage",value:function(e){var t={};try{t="string"==typeof e?JSON.parse(e):{}}catch(t){console.error("Cannot parse native message '".concat(e,"'\n\t").concat(t.message))}return t}},{key:"_mapMessage",value:function(e){var t=e.op,n=e.payload;return{operation:t,payload:n}}}]),e}(),_u=bu,Eu=function(e){function t(){var e;return Ar(this,t),e=Lr(this,Br(t).call(this)),e.init(),e}return Ur(t,e),xr(t,[{key:"init",value:function(){var e=this.navigationStack.createRoute("".concat(cu.NATIVE_ROUTE,"init"));this._clearStack(),this.navigationStack.push(e)}},{key:"manageStack",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r={},i=e.page,o=e.options,a=void 0===o?{}:o,s=(this.getLastRoute()||{}).page,u=a.cleanNavigationStack||!1,c=a.cleanUntil||!1;if(r.from=this.getLastRoute(),r.to=e,i!==s){var l=(n?cu.NATIVE_ROUTE:"")+i,h=Rr({},e,{page:l});u?this._clearStack():c&&this.clearStackUntil(c),delete h.options,t?this.navigationStack.replaceRoute(h):this.navigationStack.push(h)}else console.log("manageStack::UPDATE PRIVATE CHANNEL. FROM WEB TO NATIVE. WEB PAGE MUST BE ????: ",s,"->",i);return r}},{key:"addSkipNavigation",value:function(e){console.log("Router:addSkipNavigation",e),this.navigationStack.addSkipNavigation(e)}},{key:"_wait",value:function(e){var t=new Date,n=null;do n=new Date;while(n-t<e)}},{key:"back",value:function(){var e={};if(this.navigationStack.length>1){var n=this.navigationStack.pop(),r=n,i=this.getLastRoute();for(console.log("back::",n,i);this.navigationStack.isSkipNavigation({from:r.page,to:i.page})&&this.navigationStack.length>1;)console.log("back::skipped -> ",r,i),r=this.navigationStack.pop(),this.navigationStack.length>0&&(i=this.getLastRoute());var o=this.isNativeRoute(n),a=this.isNativeRoute(i),s=i.page.replace(cu.NATIVE_ROUTE,""),u=i.params;e.from=n,e.to=i,a?Ti.emit(su.NATIVE_BACKSTEP_REQUEST,{page:s}):o&&Ti.emit(su.INTERNAL_ROUTER_BACKSTEP_FROM_NATIVE,{page:s}),a?this._wait(800):jr(Br(t.prototype),"go",this).call(this,s,u)}else e.from=this.getLastRoute(),e.to=this.getLastRoute();return e}},{key:"isNativeRoute",value:function(e){var t=e.page;return t&&t.startsWith(cu.NATIVE_ROUTE)}},{key:"invalidateLocationHash",value:function(){this.locationHash("")}},{key:"locationHash",value:function(e){console.log("locationHash: ",e),Promise.resolve().then(function(){return setTimeout(function(){console.log("pr locationHash: ",e),location.hash="#!"+e},100)})}},{key:"createRoute",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{page:e,params:t}}}]),t}(ka),ku=Eu,wu=function(e){function t(){return Hr(this,t),zr(this,Kr(t).apply(this,arguments))}return Yr(t,e),qr(t,[{key:"cacheSelected",value:function(){var e=this.cache[this.selected],t=this.cache;if(e){for(var n in t)t.hasOwnProperty(n)&&n!==e.name&&(t[n].cache(),t[n].resetNextNavigation());this.selected=null,e.native()}}},{key:"selectTemplate",value:function(e){var t=this.cache[e];t&&"native"===t.node.getAttribute("state")&&(this.selected=e,t.activate())}}]),t}(ru),Cu=wu,Tu=function(e){function t(){return $r(this,t),ei(this,ii(t).apply(this,arguments))}return oi(t,e),Zr(t,[{key:"initPrivateChannel",value:function(e,n){var r=e||"cells-native-route:init",i=n||"cells-native-route:init";r!==i&&(this.appState&&this.appState.from===r&&this.appState.to===i||(ni(ii(t.prototype),"initPrivateChannel",this).call(this,e,n),this.appState={from:r,to:i}))}}]),t}(za),Su=Tu,Pu=Hi.bindingCodes,Ou=Hi.externalEventsCodes,Nu=su.PRIVATE,Ru=5e3,Au=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ci(this,t),console.log("CellsNativeBridge()"),e=fi(this,gi(t).call(this,n)),e._initialRouteHandled=!1,e._shouldInitPrivateEvents=!1,e._initEvents(),e._initComponentConnector(),e._doPreRender(n),e._notifyBridgeReady(),e._lastLogoutTime=0,e}return yi(t,e),hi(t,[{key:"_initDependencies",value:function(e){console.log("CellsNativeBridge::_initDependencies()"),e=ui({NativeManager:_u,ComponentConnector:vu,Router:ku,TemplateManager:Cu,BridgeChannelManager:Su},e),vi(gi(t.prototype),"_initDependencies",this).call(this,e)}},{key:"publish",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};vi(gi(t.prototype),"publish",this).call(this,e,n);var i=this._parsePublishOptions(r),o=i.forwardToNative;o&&this._handleSyncDataToNative({detail:e})}},{key:"_parsePublishOptions",value:function(e){var t=e.forwardToNative,n=void 0!==t&&t;return{forwardToNative:n}}},{key:"navigateToNative",value:function(e,t){var n=su.NATIVE_NAVIGATION_REQUEST;Ti.emit(n,{event:{},detail:{page:e,params:t}})}},{key:"backStep",value:function(){var e=Ou.ROUTER_BACKSTEP;Ti.emit(e,{event:{},detail:{}})}},{key:"resetRouter",value:function(){var e=this;Ti.removeListener("nav-request",this.navRequestListener),this.Router=new ku(this),this.Router.handler=function(){return e.routeHandler()},this.Router.addRoutes(this.routes),this._initSkipNavigations(),this.Router.start(),this.Router.hashIsDirty=!1,Ti.on("nav-request",this.navRequestListener)}},{key:"routeHandler",value:function(){if(vi(gi(t.prototype),"routeHandler",this).call(this),!this._initialRouteHandled){var e=this.Router.currentRoute,n=e.name,r=e.params,i=this.Router.createRoute(n,r);this.handleForward(i),this._initialRouteHandled=!0,console.log("CellsNativeBridge::routeHandler()",i)}}},{key:"_cacheSelected",value:function(){this.TemplateManager.cacheSelected(),this.Router.currentRoute=this.Router.navigationStack.createRoute(cu.NATIVE_ROUTE+"init")}},{key:"resetWebView",value:function(){this._shouldInitPrivateEvents=!0,this.Router.init(),this._cacheSelected(),this._resetBridgeChannels(),this._removeTemplates(),this._resetEventSubscriptions()}},{key:"canDoLogout",value:function(){var e=(new Date).getTime(),t=this._lastLogoutTime>0?e-this._lastLogoutTime:e;return t>Ru}},{key:"logoutDueToNativeRequest",value:function(){this.canDoLogout()&&(this._lastLogoutTime=(new Date).getTime(),this._resetBridgeChannels(),this._removeTemplates(),this.TemplateManager.selected="",this._resetEventSubscriptions(),this.Router.invalidateLocationHash(),this.Router.hashIsDirty=!0,this._initialRouteHandled=!1,this._shouldInitPrivateEvents=!1,this._initComponentConnector(),this.preRenderConfig&&this._preRender(this.preRenderConfig,!1),this.resetRouter())}},{key:"logout",value:function(){var e=this.initialTemplate.indexOf(cu.NATIVE_ROUTE),t=0===e,n=t?this.initialTemplate.substring(cu.NATIVE_ROUTE.length):this.initialTemplate;if(this._resetBridgeChannels(),this._removeTemplates(),this.Router.init(),t){var r={page:n,options:{cleanNavigationStack:!0}};this._shouldInitPrivateEvents=!0,this.handleForward(r,!1,!0),this.NativeManager.sendNavigationMessage(r.page,{},!0),this._cacheSelected()}else this.Router.go(n);this._resetEventSubscriptions(),this._initComponentConnector()}},{key:"_removeTemplates",value:function(){this.TemplateManager.removeTemplateChildrens(this.crossContainerId),this.TemplateManager.removeTemplates(this.initialTemplate,this.crossContainerId),this.TemplateManager.removeTemplate(this.initialTemplate)}},{key:"_resetEventSubscriptions",value:function(){this._addInitialSubscribersToEvents()}},{key:"_onConfigChange",value:function(e){if(window.AppConfig&&e.detail){for(var t in e.detail)e.detail.hasOwnProperty(t)&&("config"===t?window.AppConfig.app=e.detail[t]:window.AppConfig[t]=e.detail[t]);this.PageManager.storage.clear(),this._removeTemplates(),this.routeHandler()}}},{key:"_onLocaleChange",value:function(e){window.I18nMsg&&e.detail&&e.detail.lang&&(window.I18nMsg.lang=e.detail.lang)}},{key:"_initEvents",value:function(){var e=this;Ti.on(su.SYNC_CHANNELS_DATA,function(t){return e._handleNativeSyncChannelsData(t)}),Ti.on(su.ROUTER_NAVIGATION,function(t){return e._handleNavigationRequest(t)}),Ti.on(su.ROUTER_BACKSTEP,function(t){return e._handleBackRequest(t)}),Ti.on(su.RESET_WEBVIEW,function(){return e.resetWebView()}),Ti.on(su.NATIVE_LOGOUT,function(){return e.logoutDueToNativeRequest()}),Ti.on(su.UPDATE_SKIP_NAVIGATIONS,function(t){return e.updateSkipNavigations(t)}),Ti.on(su.INTERNAL_ROUTER_NAVIGATION,function(t){return e._handleNavigationStack(t)}),Ti.on(su.INTERNAL_ROUTER_BACKSTEP,function(){return e.handleBack({type:su.INTERNAL_ROUTER_BACKSTEP})}),Ti.on(su.INTERNAL_ROUTER_BACKSTEP_FROM_NATIVE,function(t){return e._handleBackRequestFromNative(t)}),Ti.on(su.NATIVE_NAVIGATION_REQUEST,function(t){return e._handleNativeNavRequest(t)}),Ti.on(su.NATIVE_BACKSTEP_REQUEST,function(){return e._handleNativeBack()}),Ti.on(su.NATIVE_CHANNEL_SYNC,function(t){return e._handleSyncDataToNative(t)})}},{key:"_initComponentConnector",value:function(){this.ComponentConnector.handleI18n(this._onLocaleChange.bind(this)),this.ComponentConnector.handleConfig(this._onConfigChange.bind(this)),this.ComponentConnector.handleAppContextChange(this._onAppContextChanged.bind(this))}},{key:"_doPreRender",value:function(e){if(e.initialPreRender){var t={pages:e.initialPreRender};this.preRenderConfig=t,this._preRender(t,!1)}}},{key:"_onAppContextChanged",value:function(e){var t=e.detail.value;t.fromPage&&(this.NativeManager.sendPageStatusMessage(t.currentPage,!0),this.NativeManager.sendPageStatusMessage(t.fromPage,!1))}},{key:"_notifyBridgeReady",value:function(){this.NativeManager.sendBridgeReadyMessage()}},{key:"_handleBackRequest",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};console.log("CellsNativeBridge::_handleBackRequest()");var t=this.Router.getLastRoute();e.willAppear&&!this.Router.isNativeRoute(t)||Ti.emit(su.INTERNAL_ROUTER_BACKSTEP)}},{key:"registerCurrentTemplate",value:function(e,t){var n=cu.NATIVE_ROUTE+"init",r=Ou.TEMPLATE_REGISTERED,i=Pu.UI,o=this;this._isNewStateIsEqualToOldState(e.name,(t||{}).name)||(t&&t!==e&&n!==t.name&&this.unregisterChildren(t,o.binding===i?"DM":null),this.registerChildren(e,o.binding===i?"DM":null),this._updateChannels(t,e),Ti.emit(r,{template:e.name}))}},{key:"_handleBackRequestFromNative",value:function(e){console.log("CellsNativeBridge::_handleBackRequestFromNative()");var t=e.page;this.TemplateManager.selectTemplate(t)}},{key:"_handleNavigationRequest",value:function(e){var t=e.page;console.log("_handleNavigationRequest : to ",t);var n=new CustomEvent(Nu.ROUTER_NAVIGATION,{detail:this._prepareNavigationParams(e),bubbles:!0,composed:!0});this._shouldInitPrivateEvents&&(this._shouldInitPrivateEvents=!1,this.routeHandler()),this.TemplateManager.selectTemplate(t),Ti.emit(su.INTERNAL_ROUTER_NAVIGATION,{detail:e,event:n}),console.log("_handleNavigationRequest : to NATIVE : ".concat(t))}},{key:"_prepareNavigationParams",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=ui({},e);for(var n in t.params)t.params.hasOwnProperty(n)&&(t[n]=t.params[n],t.params[n]=n);return t}},{key:"_handleNavigationStack",value:function(e){console.log("INFO ",e);var t=this._unflattenRouteFromEvent(e),n=e.detail.options||{};console.log("_handleNavigationStack options.skipHistory :",n.skipHistory),console.log("_handleNavigationStack :from",this.Router.getLastRoute().page,t.page),n.skipHistory!==!0&&n.skipHistory!==!1||this.Router.addSkipNavigation({from:e.detail.page,to:this.Router.getLastRoute().page,skipHistory:n.skipHistory}),this.handleForward(t,t.replace)}},{key:"_isNewStateIsEqualToOldState",value:function(e,t){console.log("_isNewStateIsEqualToOldState COMPARE",this.appState);var n=cu.NATIVE_ROUTE+"init",r=t===n||void 0===t,i=(this.appState||{}).previousPage===n||void 0===(this.appState||{}).previousPage,o=this.appState&&this.appState.currentPage===e&&(this.appState.previousPage===t||i===r);return console.log("_isNewStateIsEqualToOldState skip=",o),o}},{key:"_updateChannels",value:function(e,t){if(this.BridgeChannelManager){var n=e?e.name:void 0,r=t.name,i={from:{page:n},to:{page:r}},o=this.shouldInitPrivateEvents(i);o||n===r||(this.BridgeChannelManager.initPrivateChannel(n,r),this.BridgeChannelManager.updateAppContext(n,r))}}},{key:"shouldInitPrivateEvents",value:function(e){return this.Router.isNativeRoute(e.from)||this.Router.isNativeRoute(e.to)}},{key:"updatePrivateChannels",value:function(e,t){if(this.BridgeChannelManager){var n=e?e.page:void 0;this.BridgeChannelManager.updateAppContext(n,t.page),this.BridgeChannelManager.initPrivateChannel(n,t.page)}}},{key:"handlePrivateChannelsForNavigation",value:function(e){this.shouldInitPrivateEvents(e)&&this.updatePrivateChannels(e.from,e.to)}},{key:"onNativeBackStepRequest",value:function(){return{continue:!0}}},{key:"_doBeforeBack",value:function(e){return Promise.resolve(this.onNativeBackStepRequest(e))}},{key:"goBack",value:function(){var e=vi(gi(t.prototype),"goBack",this).call(this);return this.handlePrivateChannelsForNavigation(e),e}},{key:"handleBack",value:function(e){var t=this,n=this.Router.navigationStack.lastNavigation(),r={currentPage:n.to,backToPage:n.from};e.type===su.INTERNAL_ROUTER_BACKSTEP?this._doBeforeBack(r).then(function(e){e.continue===!0?t.goBack():(e.cancelledNavigation=r,t.BridgeChannelManager.publishCancelledBackNavigation(e))}):this.goBack()}},{key:"handleForward",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.Router.manageStack(e,t,n);this.handlePrivateChannelsForNavigation(r)}},{key:"_unflattenRouteFromEvent",value:function(e){var t=e.detail,n=t.page,r=t.params,i=t.cleanNavigationStack,o=void 0!==i&&i,a=t.cleanUntil,s=void 0!==a&&a,u=t.replace,c=void 0!==u&&u,l=e.event.detail,h={},f={page:n,params:this._unflattenRouteParams(r,l,!0),replace:c};return o&&(h.cleanNavigationStack=o),s&&(h.cleanUntil=s),Object.keys(h).length>0&&(f.options=h),f}},{key:"_unflattenRouteParams",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r={};return Object.keys(e).forEach(function(i){var o=n?e[i]:i,a=t[i];a?r[o]=a:console.error("Error trying to unflat value from param ".concat(i," - value is not presented on value list (").concat(JSON.stringify(t),")"))}),r}},{key:"_handleSyncDataToNative",value:function(e){var t=e.detail,n=this.ComponentConnector.getChannel(t);this.NativeManager.sendSyncChannelsDataMessage([n])}},{key:"_handleNativeNavRequest",value:function(e){console.log("CellsNativeBridge::_handleNativeNavRequest()");var t=this._unflattenNavigationData(e),n=t.resetChannels||!1;n?this.NativeManager.resetChannels():this._syncChannelsToNative(),this.handleForward(t,!1,!0),this.NativeManager.sendNavigationMessage(t.page,t.params),this.TemplateManager.cacheSelected()}},{key:"_unflattenNavigationData",value:function(e){var t=e.event.detail,n=ui({},e.detail),r=n.cleanNavigationStack,i=void 0!==r&&r,o=n.cleanUntil,a=void 0!==o&&o,s=n.params,u={},c=this._unflattenRouteParams(s,t,!0);return c&&(n.params=c),i&&(u.cleanNavigationStack=i),a&&(u.cleanUntil=a),Object.keys(u).length>0&&(n.options=u),n}},{key:"_handleNativeBack",value:function(){console.log("CellsNativeBridge::_handleNativeBack()"),this._syncChannelsToNative(),this.NativeManager.sendBackstepMessage(),this._cacheSelected()}},{key:"updateSkipNavigations",value:function(e){var t=this,n=e.navigations;n.forEach(function(e){t.Router.addSkipNavigation(e)})}},{key:"_handleNativeSyncChannelsData",value:function(e){console.log("CellsNativeBridge::_handleNativeSyncChannelsData()"),this.ComponentConnector.syncChannels(e.channels)}},{key:"_syncChannelsToNative",value:function(){var e=this.ComponentConnector.getChannels();this.NativeManager.sendSyncChannelsDataMessage(e)}}]),t}(ou),Iu=Au,xu={native:{windowExport:"CellsNativeBridge",library:"cellsNative",file:"cells-native-bridge",version:"0.11.0"},polymer:{windowExport:"CellsPolymerBridge",library:"cellsPolymer",file:"cells-polymer-bridge",version:"3.5.0"},core:{windowExport:"CellsBridge",library:"cells",file:"cells-bridge",version:"1.0.0"}}.native||{native:{windowExport:"CellsNativeBridge",library:"cellsNative",file:"cells-native-bridge",version:"0.11.0"},polymer:{windowExport:"CellsPolymerBridge",library:"cellsPolymer",file:"cells-polymer-bridge",version:"3.5.0"},core:{windowExport:"CellsBridge",library:"cells",file:"cells-bridge",version:"1.0.0"}}.core,Lu=xu.windowExport;window[Lu]=Iu}])});
//# sourceMappingURL=cells-native-bridge.min.js.map